(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[127],{175:function(e,t,a){e.exports={container:"Schemas_container__3H0XX",group:"Schemas_group__QeGXq",schema:"Schemas_schema__36IFP",formLabel:"Schemas_formLabel__1geS0",formControl:"Schemas_formControl__2ycln"}},178:function(e,t,a){e.exports={container:"App_container__2zgzu",sidebar:"App_sidebar__10tAV",content:"App_content__3I8HS"}},179:function(e,t,a){e.exports={container:"FormAlerts_container__JPYH9"}},180:function(e,t,a){e.exports={container:"FormField_container__3nG83",label:"FormField_label__2Au43"}},181:function(e,t,a){e.exports={dryRun:"ImportButtonStrip_dryRun__112kw"}},182:function(e,t,a){e.exports={container:"JobOverview_container__1_oyo",items:"JobOverview_items__2B1hs",Menu:"JobOverview_Menu__2bTUp",summary:"JobOverview_summary__13xs1"}},183:function(e,t,a){e.exports={container:"MenuLabel_container__ZTyjb",status:"MenuLabel_status__1UTMj",date:"MenuLabel_date__1r_sY"}},189:function(e,t,a){e.exports={container:"JobSummary_container__2Zh6N",title:"JobSummary_title__sZ7p4",taskDetails:"JobSummary_taskDetails__3aEqI",tags:"JobSummary_tags__3qnhf"}},190:function(e,t,a){e.exports={rest:"Summary_rest__GeByI"}},191:function(e,t,a){e.exports={container:"MoreOptions_container__2zKqV",header:"MoreOptions_header__120Ww"}},192:function(e,t,a){e.exports={container:"OrgUnitTree_container__tSgX2"}},193:function(e,t,a){e.exports={container:"Page_container__3NEqL",content:"Page_content__39Ql1",preBody:"Page_preBody__3d4Jp",header:"Page_header__13-dA",title:"Page_title__rl9Ut",desc:"Page_desc__2uKSe",icon:"Page_icon__20L2r",iconAndTitle:"Page_iconAndTitle__32JzE"}},194:function(e,t,a){e.exports={inputs:"RadioGroup_inputs__2MDMV",radio:"RadioGroup_radio__2G6wY"}},195:function(e,t,a){e.exports={container:"JobOverview_container__F-fbL"}},202:function(e,t,a){e.exports={select:"Select_select__3_2MB"}},203:function(e,t,a){e.exports={body:"SelectableList_body__80Xuu",filter:"SelectableList_filter__SHsK2",actions:"SelectableList_actions__1Pw1O",action:"SelectableList_action__kmkJr"}},204:function(e,t,a){e.exports={Menu:"Sidebar_Menu__3Gy0D",sectionTitle:"Sidebar_sectionTitle__lKKbo",jobOverview:"Sidebar_jobOverview__2MJ0c"}},205:function(e,t,a){e.exports={link:"StyledLink_link__1GAq7"}},206:function(e,t,a){"use strict";a.r(t);var l=a(1),n=a.n(l),r=a(167),c=a(6),s=a.n(c),o=a(4);const i=n.a.createContext(void 0),m=n.a.createContext(void 0),d=e=>Object.keys(e).map(t=>e[t]).sort((e,t)=>e.created<t.created?1:-1)[0];var u=a(11),p=a(7);const E=(e,t)=>({width:e||24,height:t||24,display:"inline-block",fill:"current-color",color:"current-color",userSelect:"none"}),v=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-metadataimport"},n.a.createElement("path",{d:"M14.039 8.968l-3.961-3.968h1.968s.991-3.178-2.985-5c6.191.222 6.972 5 6.972 5h1.967l-3.961 3.968zm6.461 5.575l-.342.195v1.717l.342-.195v-1.717zm-.844.481l-.35.199v1.717l.35-.199v-1.717zm.906-10.024l-1.306 1.55 1.62.919-6.859 3.698-8.86-5.138 4.436-2.685c-.234-.5-.626-.989-1.313-1.338l-5.124 2.978-3.156 5.487 2 1.106v5.445l12.25 6.978 9.75-5.551v-11.508l-3.438-1.941zm-16.624 2.688l7.897 4.54-1.192 2.091-7.872-4.605 1.167-2.026zm9.062 13.298l-9-5.126v-3.112l7.377 4.319 1.623-2.845v6.764zm9-3.7l-7 3.985v-8.361l7-3.773v8.149zm-4.907-.802l-.349.199v1.713l.349-.195v-1.717zm.584-.333l-.343.195v1.717l.343-.195v-1.717zm1.395-.794l-.343.195v1.717l.343-.195v-1.717zm-.574.327l-.344.196v1.717l.344-.196v-1.717z"})),b=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-metadataexport"},n.a.createElement("path",{d:"M13.904 9c-3.514-3.984-.1-7.598-.1-7.598l-1.393-1.389 5.589-.013v5.607l-1.372-1.391c0 .001-3.581.706-2.724 4.784zm5.752 6.024l-.35.199v1.717l.35-.199v-1.717zm.844-.481l-.342.195v1.717l.342-.195v-1.717zm-3.407 1.941l-.349.199v1.713l.349-.195v-1.717zm1.979-1.127l-.343.195v1.717l.343-.195v-1.717zm.949-10.673v2.295l.855.489-6.859 3.698-8.86-5.138 6.374-3.654-1.5-1.406-6.864 3.97-3.167 5.533 2 1.106v5.445l12.25 6.978 9.75-5.551v-11.508l-3.979-2.257zm-16.083 3.004l7.897 4.54-1.193 2.091-7.871-4.605 1.167-2.026zm9.062 13.298l-9-5.126v-3.112l5.632 3.297 1.746 1.022 1.002-1.757.62-1.088v6.764zm9-3.7l-7 3.985v-8.361l7-3.773v8.149zm-4.323-1.135l-.343.195v1.717l.343-.195v-1.717zm.821-.467l-.344.196v1.717l.344-.196v-1.717z"})),h=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-metadatadependencyexport"},n.a.createElement("path",{d:"M16.949 16.132h2.332c-1.092 1.728-3.605 3.638-6.281 3.852v-8.984h3v-2h-3v-1.103c0-2.39 2-2.619 2-4.897 0-1.654-1.346-3-3-3s-3 1.346-3 3c0 2.297 2 2.487 2 4.897v1.103h-3v2h3v9c-2.639-.18-5.133-2.053-6.281-3.868h2.332l-5.051-3.132v5.912l1.269-1.8c2.702 4.503 6.379 4.305 8.731 6.888 2.352-2.583 6.029-2.385 8.731-6.889l1.269 1.8v-5.911l-5.051 3.132zm-5.949-13.132c0-.551.449-1 1-1s1 .449 1 1-.448 1-1 1-1-.449-1-1z"})),g=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-data"},n.a.createElement("path",{d:"M6.083 4c1.38 1.612 2.578 3 4.917 3h11v13h-20v-16h4.083zm.917-2h-7v20h24v-17h-13c-1.629 0-2.305-1.058-4-3z"})),y=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-event"},n.a.createElement("path",{d:"M20 20h-4v-4h4v4zm-6-10h-4v4h4v-4zm6 0h-4v4h4v-4zm-12 6h-4v4h4v-4zm6 0h-4v4h4v-4zm-6-6h-4v4h4v-4zm16-8v22h-24v-22h3v1c0 1.103.897 2 2 2s2-.897 2-2v-1h10v1c0 1.103.897 2 2 2s2-.897 2-2v-1h3zm-2 6h-20v14h20v-14zm-2-7c0-.552-.447-1-1-1s-1 .448-1 1v2c0 .552.447 1 1 1s1-.448 1-1v-2zm-14 2c0 .552-.447 1-1 1s-1-.448-1-1v-2c0-.552.447-1 1-1s1 .448 1 1v2z"})),S=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-gml"},n.a.createElement("path",{d:"M13.144 8.171c-.035-.066.342-.102.409-.102.074.009-.196.452-.409.102zm-2.152-3.072l.108-.031c.064.055-.072.095-.051.136.086.155.021.248.008.332-.014.085-.104.048-.149.093-.053.066.258.075.262.085.011.033-.375.089-.304.171.096.136.824-.195.708-.176.225-.113.029-.125-.097-.19-.043-.215-.079-.547-.213-.68l.088-.102c-.206-.299-.36.362-.36.362zm13.008 6.901c0 6.627-5.373 12-12 12-6.628 0-12-5.373-12-12s5.372-12 12-12c6.627 0 12 5.373 12 12zm-8.31-5.371c-.006-.146-.19-.284-.382-.031-.135.174-.111.439-.184.557-.104.175.567.339.567.174.025-.277.732-.063.87-.025.248.069.643-.226.211-.381-.355-.13-.542-.269-.574-.523 0 0 .188-.176.106-.166-.218.027-.614.786-.614.395zm6.296 5.371c0-1.035-.177-2.08-.357-2.632-.058-.174-.189-.312-.359-.378-.256-.1-1.337.597-1.5.254-.107-.229-.324.146-.572.008-.12-.066-.454-.515-.605-.46-.309.111.474.964.688 1.076.201-.152.852-.465.992-.038.268.804-.737 1.685-1.251 2.149-.768.694-.624-.449-1.147-.852-.275-.211-.272-.66-.55-.815-.124-.07-.693-.725-.688-.813l-.017.166c-.094.071-.294-.268-.315-.321 0 .295.48.765.639 1.001.271.405.416.995.748 1.326.178.178.858.914 1.035.898.193-.017.803-.458.911-.433.644.152-1.516 3.205-1.721 3.583-.169.317.138 1.101.113 1.476-.029.433-.37.573-.693.809-.346.253-.265.745-.556.925-.517.318-.889 1.353-1.623 1.348-.216-.001-1.14.36-1.261.007-.094-.256-.22-.45-.353-.703-.13-.248-.015-.505-.173-.724-.109-.152-.475-.497-.508-.677-.002-.155.117-.626.28-.708.229-.117.044-.458.016-.656-.048-.354-.267-.646-.53-.851-.389-.299-.188-.537-.097-.964 0-.204-.124-.472-.398-.392-.564.164-.393-.44-.804-.413-.296.021-.538.209-.813.292-.346.104-.7-.082-1.042-.125-1.407-.178-1.866-1.786-1.499-2.946.037-.19-.114-.542-.048-.689.158-.352.48-.747.762-1.014.158-.15.361-.112.547-.229.287-.181.291-.553.572-.781.4-.325.946-.318 1.468-.388.278-.037 1.336-.266 1.503-.06 0 .038.191.604-.019.572.433.023 1.05.749 1.461.579.211-.088.134-.736.567-.423.262.188 1.436.272 1.68.069.15-.124.234-.93.052-1.021.116.115-.611.124-.679.098-.12-.044-.232.114-.425.025.116.055-.646-.354-.218-.667-.179.131-.346-.037-.539.107-.133.108.062.18-.128.274-.302.153-.53-.525-.644-.602-.116-.076-1.014-.706-.77-.295l.789.785c-.039.025-.207-.286-.207-.059.053-.135.02.579-.104.347-.055-.089.09-.139.006-.268 0-.085-.228-.168-.272-.226-.125-.155-.457-.497-.637-.579-.05-.023-.764.087-.824.11-.07.098-.13.201-.179.311-.148.055-.287.126-.419.214l-.157.353c-.068.061-.765.291-.769.3.029-.075-.487-.171-.453-.321.038-.165.213-.68.168-.868-.048-.197 1.074.284 1.146-.235.029-.225.046-.487-.313-.525.068.008.695-.246.799-.36.146-.168.481-.442.724-.442.284 0 .223-.413.354-.615.131.053-.07.376.087.507-.01-.103.445.057.489.033.104-.054.684-.022.594-.294-.1-.277.051-.195.181-.253-.022.009.34-.619.402-.413-.043-.212-.421.074-.553.063-.305-.024-.176-.52-.061-.665.089-.115-.243-.256-.247-.036-.006.329-.312.627-.241 1.064.108.659-.735-.159-.809-.114-.28.17-.509-.214-.364-.444.148-.235.505-.224.652-.476.104-.178.225-.385.385-.52.535-.449.683-.09 1.216-.041.521.048.176.124.104.324-.069.19.286.258.409.099.07-.092.229-.323.298-.494.089-.222.901-.197.334-.536-.374-.223-2.004-.672-3.096-.672-.236 0-.401.263-.581.412-.356.295-1.268.874-1.775.698-.519-.179-1.63.66-1.808.666-.065.004.004-.634.358-.681-.153.023 1.247-.707 1.209-.859-.046-.18-2.799.822-2.676 1.023.059.092.299.092-.016.294-.18.109-.372.801-.541.801-.505.221-.537-.435-1.099.409l-.894.36c-1.328 1.411-2.247 3.198-2.58 5.183-.013.079.334.226.379.28.112.134.112.712.167.901.138.478.479.744.74 1.179.154.259.41.914.329 1.186.108-.178 1.07.815 1.246 1.022.414.487.733 1.077.061 1.559-.217.156.33 1.129.048 1.368l-.361.093c-.356.219-.195.756.021.982 1.818 1.901 4.38 3.087 7.22 3.087 5.517 0 9.989-4.472 9.989-9.989zm-11.507-6.357c.125-.055.293-.053.311-.22.015-.148.044-.046.08-.1.035-.053-.067-.138-.11-.146-.064-.014-.108.069-.149.104l-.072.019-.068.087.008.048-.087.106c-.085.084.002.139.087.102z"})),T=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-plus"},n.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),n.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),f=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-minus"},n.a.createElement("path",{d:"M19 13H5v-2h14v2z"}),n.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),O=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t),"data-test":"icon-tasks"},n.a.createElement("path",{d:"M19 2h-4.2C14.4.8 13.3 0 12 0c-1.3 0-2.4.8-2.8 2H5C4 2 3 3 3 4v16c0 1 1 2 2 2h14c1 0 2-1 2-2V4c0-1-1-2-2-2zm-7 0c.6 0 1 .5 1 1s-.5 1-1 1-1-.5-1-1 .5-1 1-1zm7 18H5V4h2v3h10V4h2v16z"})),j=({width:e,height:t})=>n.a.createElement("svg",{viewBox:"0 0 24 24",style:E(e,t)},n.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.a.createElement("path",{d:"M13 1l.001 3.062A8.004 8.004 0 0 1 19.938 11H23v2l-3.062.001a8.004 8.004 0 0 1-6.937 6.937L13 23h-2v-3.062a8.004 8.004 0 0 1-6.938-6.937L1 13v-2h3.062A8.004 8.004 0 0 1 11 4.062V1h2zm-1 9a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"})),w=[{key:"data",importType:"DATAVALUE_IMPORT",icon:n.a.createElement(g,null),label:s.a.t("Data")},{key:"event",importType:"EVENT_IMPORT",icon:n.a.createElement(y,null),label:s.a.t("Event")},{key:"gml",importType:"GML_IMPORT",icon:n.a.createElement(S,null),label:s.a.t("GML")},{key:"metadata",importType:"METADATA_IMPORT",icon:n.a.createElement(v,null),label:s.a.t("Metadata")},{key:"tei",importType:"TEI_IMPORT",icon:n.a.createElement(j,null),label:s.a.t("TEI")}],k=w.map(({importType:e})=>e),D={events:{resource:"system/tasks/",id:({type:e,taskId:t})=>"".concat(e,"/").concat(t)}},A={summary:{resource:"system/taskSummaries/",id:({type:e,taskId:t})=>"".concat(e,"/").concat(t)}},N={data:{},event:{},gml:{},metadata:{},tei:{}},I={activeTypes:k,selectedJob:void 0},M=()=>{const e=Object(p.c)(),[t,a]=Object(l.useState)(N),[n,r]=Object(l.useState)(I),c=((e,t)=>async(a,l,n)=>{const r=Object(u.a)({},n),{summary:c,error:s}=await e.query(A,{variables:{type:n.importType,taskId:n.id}});s?console.error("fetchSummary error: ",s):(c&&"ERROR"==c.status&&!r.error&&(r.error=!0),r.summary=c,t(e=>Object(u.a)({},e,{[a]:Object(u.a)({},e[a],{[l]:r})})))})(e,a),s=((e,t,a)=>(l,n,r)=>{const c=async()=>{if(r.completed)return;const s=Object(u.a)({},r),{events:o,error:i}=await e.query(D,{variables:{type:r.importType,taskId:r.id}});if(i)console.error("fetchEvents error: ",i);else{if(o&&o.length){const e=o.filter(e=>!r.events.some(t=>t.id==e.uid)).map(e=>({id:e.uid,level:e.level,text:e.message,date:new Date(e.time)})),t=e.find(e=>"ERROR"==e.level);t&&(s.error=t.text),s.events=[...s.events,...e.reverse()],s.completed=o[0].completed}s.lastUpdated=new Date,s.completed?a(l,n,s):setTimeout(()=>c(l,n,s),2e3),t(e=>Object(u.a)({},e,{[l]:Object(u.a)({},e[l],{[n]:s})}))}};c()})(e,a,c);return{tasks:t,addTask:((e,t)=>(a,l,n)=>{e(e=>Object(u.a)({},e,{[a]:Object(u.a)({},e[a],{[l]:n})})),t(a,l,n)})(a,s),jobOverview:n,updateJobOverview:(e=>t=>{e(e=>Object(u.a)({},e,{},t))})(r)}},_={user:{resource:"me"}},C={data:{resource:"programs",fields:"id,displayName",id:({id:e})=>"".concat(e),params:{fields:"programStages[id,displayName]",paging:"false"}}},U="[ ".concat(s.a.t("All program stages")," ]"),x={keys:{resource:"metadata/csvImportClasses"}};var R=a(178),F=a.n(R);const P={json:"application/json",xml:"application/xml",csv:"application/csv",gml:"application/xml",adx:"application/adx+xml",pdf:"application/pdf"},L=({url:e,upload:t,type:a,onResponse:l,onError:n,setProgress:r,format:c})=>{const s=new XMLHttpRequest,o=(e=>P[e]||null)(c);return s.withCredentials=!0,s.open("POST",e,!0),s.setRequestHeader("Content-Type",o),s.setRequestHeader("Content-Disposition",'attachment filename="'+t.name+'"'),s.onreadystatechange=J({xhr:s,type:a,onResponse:l,onError:n}),s.upload.onprogress=V(r),s},J=({xhr:e,type:t,onResponse:a,onError:l})=>n=>{const r=Math.floor(e.status/100);if(4===e.readyState&&2===r){const l=z(e);a(Object(u.a)({},l,{type:t}))}else 4===e.readyState&&l(n)},z=e=>{const t=JSON.parse(e.responseText),{message:a,status:l,typeReports:n,response:r}=t;return l&&"ERROR"===l&&Array.isArray(n)&&Array.isArray(n[0].objectReports)&&Array.isArray(n[0].objectReports[0].errorReports)?{error:!0,msg:{id:"init",text:n[0].objectReports[0].errorReports[0].message,date:new Date},typeReports:t}:"undefined"!==typeof r?{id:r.id,msg:{id:"init",text:a,date:new Date(r.created)}}:{error:!0}},V=e=>t=>{if(t.lengthComputable){const a=parseInt(t.loaded/t.total*100);e(Math.max(1,a))}},K=e=>{const t=e.split("/");return t[t.length-1]},q=e=>"".concat(e.getFullYear().toString(),"-").concat((e.getMonth()+1).toString().padStart(2,0),"-").concat(e.getDate().toString().padStart(2,0)),H=e=>"".concat(q(e)," ").concat(e.getHours().toString().padStart(2,0),":").concat(e.getMinutes().toString().padStart(2,0),":").concat(e.getSeconds().toString().padStart(2,0),"\n"),B=(e,t)=>"gzip"===t?"application/".concat(e,"+gzip"):"zip"===t?"application/".concat(e,"+zip"):"xml"===e?"application/xml":"json"===e?"application/json":void 0,G=(e,t,a="none")=>URL.createObjectURL(new Blob([e],{type:B(t,a)})),X=(e,t)=>{const a=document.createElement("a");a.href=e,a.setAttribute("download",t),document.body.appendChild(a),a.click(),a.remove()},Y=async(e,t)=>{const a="unique:eq:true&filter=".concat(t,":eq:true"),l="".concat(e,"attributes.json?paging=false&fields=").concat("id,displayName","&filter=").concat(a);return(await(e=>fetch(e,{credentials:"include"}).then(e=>{if(e.status>=200&&e.status<300)return Promise.resolve(e.json());throw e}).catch(e=>{const a=new Error(e.statusText||e.status);return console.error("fetchAttributes ".concat(t," fetch error: "),a),Promise.reject(a)}))(l).catch(e=>Promise.reject(e))).attributes.map(({id:e,displayName:t})=>({value:"ATTRIBUTE:".concat(e),label:t}))},W=s.a.t("An unknown error occurred. Please try again later"),Z=e=>t=>{const a=(new Date).getTime();return e(0),{id:"xhr-".concat(a),critical:!0,message:t||W}},$=({url:e,file:t,format:a,type:l,setProgress:n,addEntry:r})=>{n(1);const c=Z(n);return new Promise((s,o)=>{try{L({url:e,upload:t,type:l,onResponse:({error:e,id:t,msg:a,typeReports:i})=>{let m;m=e&&a?{id:(new Date).getTime(),level:"ERROR",created:new Date,lastUpdated:new Date,completed:!0,events:[a],summary:i,error:!0,importType:l}:e?{id:(new Date).getTime(),level:"ERROR",created:new Date,lastUpdated:new Date,completed:!0,summary:void 0,error:!0,importType:l}:{id:t,level:"INFO",created:new Date,lastUpdated:new Date,completed:!1,events:[a],summary:void 0,error:!1,importType:l},r(m.id,m),e&&o(c(a&&a.text)),n(0),s({})},onError:e=>{let t;try{t=JSON.parse(e.target.response).message}catch(a){t=W}console.error("sendFile error",t),o(c(t))},setProgress:n,format:a}).send(t)}catch(i){o(Z(i))}})},Q=e=>{window.locationAssign?window.locationAssign(e):window.location=e},ee=(e,t)=>{if(!e||!e.id)return{};const a=t[e.id];return a?a.jobDetails:{}};var te=a(3),ae=a.n(te);const le=[{value:"json",label:s.a.t("JSON")},{value:"csv",label:s.a.t("CSV")},{value:"xml",label:s.a.t("XML")}],ne=le.filter(e=>"csv"!=e.value),re=[...le,{value:"adx",label:s.a.t("ADX")}],ce=[...re,{value:"pdf",label:s.a.t("PDF")}],se=[...le,{value:"jsonp",label:s.a.t("JSONP")}],oe=[{value:"zip",label:s.a.t("Zip")},{value:"gz",label:s.a.t("GZip")},{value:"",label:s.a.t("Uncompressed")}],ie=[{value:"dataSets",label:s.a.t("Data sets")},{value:"programs",label:s.a.t("Programs")},{value:"categoryCombos",label:s.a.t("Category combination")},{value:"dashboards",label:s.a.t("Dashboard")},{value:"dataElementGroups",label:s.a.t("Data element groups")},{value:"optionSets",label:s.a.t("Option sets")}],me=[{value:"UID",label:s.a.t("Uid")},{value:"CODE",label:s.a.t("Code")},{value:"NAME",label:s.a.t("Name")}],de=[{value:"UID",label:s.a.t("Uid")},{value:"CODE",label:s.a.t("Code")},{value:"NAME",label:s.a.t("Name")}],ue=[{value:"UID",label:s.a.t("Uid")},{value:"CODE",label:s.a.t("Code")}],pe=[...ue],Ee=[{value:"SELECTED",label:s.a.t("Selected organisation unit")},{value:"CHILDREN",label:s.a.t("Include children of organisation unit")},{value:"DESCENDANTS",label:s.a.t("Include descendants of organisation unit")}],ve=(s.a.t("Skip check"),s.a.t("Check"),[{value:"NEW_AND_UPDATES",label:s.a.t("New and updates")},{value:"NEW",label:s.a.t("New only")},{value:"UPDATES",label:s.a.t("Updates only")},{value:"DELETE",label:s.a.t("Delete")}]),be=[{value:"CREATE_AND_UPDATE",label:s.a.t("New and updates")},{value:"CREATE",label:s.a.t("New only")},{value:"UPDATES",label:s.a.t("Updates only")},{value:"DELETE",label:s.a.t("Delete")}],he=[{value:"UID",label:s.a.t("UID")},{value:"CODE",label:s.a.t("Code")},{value:"AUTO",label:s.a.t("Auto")}],ge=[{value:"ERRORS",label:s.a.t("Errors")},{value:"FULL",label:s.a.t("Full")},{value:"DEBUG",label:s.a.t("Debug")}],ye=[{value:"REFERENCE",label:s.a.t("Reference")},{value:"ALL",label:s.a.t("All")},{value:"NONE",label:s.a.t("None")}],Se=[{value:"ALL",label:s.a.t("All")},{value:"NONE",label:s.a.t("None")}],Te=[{value:"MERGE",label:s.a.t("Merge")},{value:"REPLACE",label:s.a.t("Replace")}],fe=[{value:"AUTO",label:s.a.t("Auto")},{value:"OBJECT",label:s.a.t("Object")}],Oe=[{value:"NON_NULL",label:s.a.t("Non Null")},{value:"ALWAYS",label:s.a.t("Always")},{value:"NON_EMPTY",label:s.a.t("Non Empty")}],je=[{value:"SELECTED",label:s.a.t("Selected organisation units")},{value:"CHILDREN",label:s.a.t("Include children of selected organisation units")},{value:"DESCENDANTS",label:s.a.t("Include descendants of selected organisation unit")},{value:"ACCESSIBLE",label:s.a.t("Data view organisation units associated with the current user")},{value:"CAPTURE",label:s.a.t("Data capture organisation units associated with the current user")},{value:"ALL",label:s.a.t("All organisation units in the system")}],we=[{value:"NONE",label:s.a.t("None")},{value:"PROGRAM",label:s.a.t("Program")},{value:"TE",label:s.a.t("Tracked entity")}],ke=[{value:"ALL",label:s.a.t("All")},{value:"ACTIVE",label:s.a.t("Active")},{value:"COMPLETED",label:s.a.t("Completed")},{value:"CANCELLED",label:s.a.t("Cancelled")}],De=[{value:"ALL",label:s.a.t("All")},{value:"TRUE",label:s.a.t("True")},{value:"FALSE",label:s.a.t("False")}],Ae=[{value:"NONE",label:s.a.t("None")},{value:"DATE",label:s.a.t("Start and end date")},{value:"DURATION",label:s.a.t("Duration")}],Ne=[{value:"ANY",label:s.a.t("Any")},{value:"CURRENT",label:s.a.t("Current")},{value:"NONE",label:s.a.t("None")},{value:"PROVIDED",label:s.a.t("Provided")}],Ie=le[0],Me=oe[0],_e=ie[0],Ce=me[0],Ue=de[0],xe=ue[0],Re=pe[0],Fe=Ee[0],Pe=ve[0],Le=he[0],Je=ge[0],ze=ye[0],Ve=be[0],Ke=Se[0],qe=Te[0],He=fe[0],Be=Oe[0],Ge=je[0],Xe=we[0],Ye=ke[0],We=De[0],Ze=Ae[0],$e=Ne[0],Qe=ae.a.exact({value:ae.a.string.isRequired,label:ae.a.string.isRequired}),et=(ae.a.arrayOf(Qe),({name:e,label:t,dataTest:a})=>{const{baseUrl:r}=Object(p.b)(),[c,o]=Object(l.useState)(!0),[i,m]=Object(l.useState)([]),[d,u]=Object(l.useState)(void 0);Object(l.useEffect)(()=>{Y("".concat(r,"/api/"),"dataElementAttribute").then(e=>m(e)).catch(e=>u(e)),o(!1)},[]);const E=d&&"".concat(s.a.t("Something went wrong when loading the additional data element ID schemes")," : ").concat(d.message),v=[...me,...i];return n.a.createElement(Ic,{name:e,label:t,options:v,dataTest:a,loading:c,validationText:E,error:!!d,dense:!0})}),tt={dataSets:{resource:"dataSets",params:{fields:"id,displayName",paging:"false"}}},at=({label:e,selected:t,setSelected:a,meta:r,multiSelect:c=!0,withFilter:i=!0,withActions:m=!0,dataTest:d})=>{const[u,E]=Object(l.useState)([]),[v,b]=Object(l.useState)(void 0),{loading:h}=Object(p.d)(tt,{onComplete:e=>{const t=e.dataSets.dataSets.map(({id:e,displayName:t})=>({value:e,label:t}));E(t)},onError:e=>{b(e),console.error("DataSetPicker error: ",e)}}),g=!h&&!v;return n.a.createElement(jt,{label:e,dataTest:d},h&&n.a.createElement(o.i,{dataTest:"".concat(d,"-loading")}),v&&n.a.createElement("div",{"data-test":"".concat(d,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the data sets!")),n.a.createElement("p",null,v.message)),g&&n.a.createElement(Cc,{name:"dataSetPicker",label:s.a.t("Filter data sets by name"),selected:t,setSelected:a,multiSelect:c,list:u,withFilter:i,withActions:m,dataTest:"".concat(d,"-list")}),(r.touched||!r.pristine)&&r.error&&n.a.createElement(o.o,{error:!0},r.error))};var lt=a(166),nt=a(168);const rt=e=>0==e.length?s.a.t("At least one data set must be selected"):void 0,ct=e=>1!=e.length?s.a.t("One data set must be selected"):void 0,st=e=>{let{input:{value:t,onChange:a},meta:l}=e,r=Object(lt.a)(e,["input","meta"]);return n.a.createElement(at,Object.assign({meta:l,selected:t,setSelected:a},r))},ot=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:st,name:t,validate:a},l))},it=({name:e,error:t,label:a,date:l,onChange:r,dataTest:c,required:s=!0})=>{const i=l&&q(l);return n.a.createElement(jt,{label:a,dataTest:c},n.a.createElement(o.p,{type:"date",name:e,value:i,onChange:({value:e})=>{r(""==e?e:new Date(e))},required:s,inputWidth:"200px",error:!!t,validationText:t}))},mt=e=>e?dt(e):void 0,dt=e=>"Invalid Date"==new Date(e)?s.a.t("Invalid date"):void 0,ut=(e,t)=>e>t?s.a.t("Start date must be before end date"):void 0,pt=(e,t)=>e<t?s.a.t("End date must be after start date"):void 0,Et=e=>{let{input:{value:t,onChange:a},meta:{error:l},inputName:r}=e,c=Object(lt.a)(e,["input","meta","inputName"]);return n.a.createElement(it,Object.assign({name:r,error:l,date:t,onChange:a},c))},vt=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:Et,name:t,validate:a,inputName:t},l))},bt=({name:e,label:t,dataTest:a})=>n.a.createElement(Ic,{name:e,label:t,options:pe,dense:!0,dataTest:a});var ht=a(164);const gt=({initialValue:e,required:t,name:a,label:l,accept:r="*",validator:c,dataTest:s})=>n.a.createElement(jt,{label:l,required:t,dataTest:s},n.a.createElement(nt.a,{component:ht.a,name:a,accept:r,required:t,initialValue:e,validate:c,dataTest:"".concat(s,"-fileinput")}));var yt=a(179),St=a.n(yt);const Tt=({alerts:e,dataTest:t})=>{const[a,r]=Object(l.useState)([]);return Object(l.useEffect)(()=>{if(e){const t=e.map(e=>n.a.createElement(o.a,{key:"alert-".concat(e.id),warning:e.warning,info:e.info,critical:e.critical,success:e.success,duration:8e3},e.message));r(t)}},[e]),0==a.length?null:n.a.createElement("div",{className:St.a.container,"data-test":t},a)};var ft=a(180),Ot=a.n(ft);const jt=({dataTest:e,label:t,required:a=!1,children:l})=>n.a.createElement("div",{className:Ot.a.container,"data-test":e},n.a.createElement("span",{className:Ot.a.label},t,a&&n.a.createElement("span",null," *")),l),wt=({name:e,label:t,dataTest:a})=>{const{baseUrl:r}=Object(p.b)(),[c,o]=Object(l.useState)(!0),[i,m]=Object(l.useState)([]),[d,u]=Object(l.useState)(void 0);Object(l.useEffect)(()=>{(async()=>{let e;const t=await Y("".concat(r,"/api/"),"dataElementAttribute").catch(t=>e=t),a=await Y("".concat(r,"/api/"),"organisationUnitAttribute").catch(t=>e=t);if(u(e),!e){const e=t.reduce((e,t)=>((e,t)=>!!t.find(({value:t})=>t===e.value))(t,a)?[...e,t]:e,[]);m(e)}o(!1)})()},[]);const E=d&&"".concat(s.a.t("Something went wrong when loading the additional ID schemes")," : ").concat(d.message),v=[...ue,...i];return n.a.createElement(Ic,{name:e,label:t,options:v,dataTest:a,loading:c,validationText:E,error:!!d,dense:!0})};var kt=a(181),Dt=a.n(kt);const At=s.a.t("Will do a test run without importing any data into the database"),Nt=({dryRunDataTest:e,importDataTest:t,form:a,dataTest:l})=>n.a.createElement("div",{"data-test":l},n.a.createElement(o.c,{dataTest:"".concat(l,"-button-strip")},n.a.createElement(o.b,{primary:!0,type:"submit",onClick:()=>a.change("dryRun",!0),dataTest:e,className:Dt.a.dryRun},s.a.t("Dry run")),n.a.createElement(o.b,{secondary:!0,type:"submit",onClick:()=>a.change("dryRun",!1),dataTest:t},s.a.t("Import"))),n.a.createElement(o.o,{dataTest:"".concat(l,"-help")},"".concat(s.a.t("Dry run"),": ").concat(At)));var It=a(182),Mt=a.n(It);const _t=w.reduce((e,t)=>(e[t.importType]=t,e),{});var Ct=a(183),Ut=a.n(Ct);const xt=({task:e})=>{return n.a.createElement("div",{className:Ut.a.container,"data-test":"job-overview-menu-label-".concat(e.id)},n.a.createElement("div",{className:Ut.a.status},n.a.createElement("span",null,(t=15,(a=e.jobDetails.files[0].name).length>t?a.substring(0,t-3)+"...":a)),n.a.createElement("br",null),n.a.createElement("span",null,e.completed?s.a.t("Completed"):s.a.t("In progress")," ")),n.a.createElement("div",{className:Ut.a.date},H(e.created)));var t,a},Rt=({activeTypes:e,setActiveTypes:t,selectedJob:a,setSelectedJob:c})=>{const{tasks:i}=Object(l.useContext)(m),d=w.map(({key:e})=>Object.keys(i[e]).map(t=>i[e][t])).flat().sort((e,t)=>e.importType>t.importType||e.createdAt>t.createdAt?-1:void 0),u=d.filter(t=>e.includes(t.importType));return Object(l.useEffect)(()=>{!a&&d.length>0&&c(d[0])},[]),a?n.a.createElement("div",{className:Mt.a.container,"data-test":"job-overview-container"},n.a.createElement("div",{className:Mt.a.items,"data-test":"job-overview-tasks"},n.a.createElement(o.s,{className:Mt.a.Menu},n.a.createElement("div",{className:Mt.a.chips,"data-test":"job-overview-chips"},w.map(({key:a,importType:l,label:r})=>n.a.createElement(o.h,{onClick:()=>(a=>{e.includes(a)?t([...e].filter(e=>e!=a)):t([...e,a])})(l),selected:e.includes(l),key:a,dataTest:"job-overview-chips-".concat(a)},r))),u.map(e=>n.a.createElement(o.t,{key:"job-overview-tasks-".concat(e.id),active:a.id==e.id,label:n.a.createElement(xt,{task:e}),onClick:()=>c(e),icon:_t[e.importType].icon})))),n.a.createElement("div",{className:Mt.a.summary,"data-test":"job-overview-summary"},n.a.createElement(ta,{task:a,dataTest:"job-summary-container",showFileDetails:!1,showJobDetails:!0}),n.a.createElement(r.b,{to:(p=a,{pathname:"/import/".concat(_t[p.importType].key),query:{id:p.id}})},n.a.createElement(o.b,{primary:!0},s.a.t("Recreate job"))))):n.a.createElement("p",null,s.a.t("No jobs started yet."));var p};var Ft=a(189),Pt=a.n(Ft);const Lt=({events:e})=>n.a.createElement(jt,{label:"".concat(s.a.t("Events")),dataTest:"job-summary-events",name:"events"},n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Time")),n.a.createElement(o.K,null,s.a.t("Message")),n.a.createElement(o.K,null,s.a.t("ID")))),n.a.createElement(o.I,null,e.map(e=>n.a.createElement(o.M,{key:"job-summary-events-".concat(e.id)},n.a.createElement(o.J,null,H(e.date)),n.a.createElement(o.J,null,e.text),n.a.createElement(o.J,null,e.id))))));var Jt=a(190),zt=a.n(Jt);const Vt={deleted:ae.a.number.isRequired,ignored:ae.a.number.isRequired,total:ae.a.number.isRequired,updated:ae.a.number.isRequired,imported:ae.a.number,created:ae.a.number},Kt=(ae.a.exact(Vt),e=>{const t=e.split(".");return t[t.length-1]}),qt=(ae.a.arrayOf(ae.a.exact({uid:ae.a.string,type:ae.a.string,property:ae.a.string,message:ae.a.string})),({status:e,description:t})=>n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Status")),n.a.createElement(o.K,null,s.a.t("Description")))),n.a.createElement(o.I,null,n.a.createElement(o.M,null,n.a.createElement(o.J,null,e),n.a.createElement(o.J,null,t))))),Ht=({importCount:e,status:t,description:a,conflicts:l,id:r})=>n.a.createElement("div",null,n.a.createElement(jt,{label:"".concat(s.a.t("Summary")," #").concat(r),dataTest:"job-summary-single-summary",name:"summary"},n.a.createElement(n.a.Fragment,null,t&&n.a.createElement(qt,{description:a,status:t}),n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Created")),n.a.createElement(o.K,null,s.a.t("Deleted")),n.a.createElement(o.K,null,s.a.t("Ignored")),n.a.createElement(o.K,null,s.a.t("Updated")),n.a.createElement(o.K,null,s.a.t("Total")))),n.a.createElement(o.I,null,n.a.createElement(o.M,null,n.a.createElement(o.J,null,e.imported),n.a.createElement(o.J,null,e.deleted),n.a.createElement(o.J,null,e.ignored),n.a.createElement(o.J,null,e.updated),n.a.createElement(o.J,null,e.total)))))),l&&n.a.createElement(jt,{label:"".concat(s.a.t("Conflicts")),dataTest:"job-summary-conflicts",name:"conflicts"},n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Object")),n.a.createElement(o.K,null,s.a.t("Value")))),n.a.createElement(o.I,null,l.map((e,t)=>n.a.createElement(o.M,{key:"job-summary-conflicts-".concat(e.object,"-").concat(t)},n.a.createElement(o.J,null,e.object),n.a.createElement(o.J,null,e.value))))))),Bt=({stats:e})=>0==e.length?null:n.a.createElement(jt,{label:"".concat(s.a.t("Type count")),dataTest:"job-summary-type-count",name:"typeCount"},n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Type")),n.a.createElement(o.K,null,s.a.t("Created")),n.a.createElement(o.K,null,s.a.t("Deleted")),n.a.createElement(o.K,null,s.a.t("Ignored")),n.a.createElement(o.K,null,s.a.t("Updated")),n.a.createElement(o.K,null,s.a.t("Total")))),n.a.createElement(o.I,null,e.map((e,t)=>n.a.createElement(o.M,{key:"job-summary-type-count-".concat(t)},n.a.createElement(o.J,null,e.type),n.a.createElement(o.J,null,e.created),n.a.createElement(o.J,null,e.deleted),n.a.createElement(o.J,null,e.ignored),n.a.createElement(o.J,null,e.updated),n.a.createElement(o.J,null,e.total)))))),Gt=(Object(u.a)({},Vt,{type:ae.a.string.isRequired}),({messages:e})=>0==e.length?null:n.a.createElement(jt,{label:"".concat(s.a.t("Messages")),dataTest:"job-summary-messages",name:"messages"},n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("UID")),n.a.createElement(o.K,null,s.a.t("Type")),n.a.createElement(o.K,null,s.a.t("Property")),n.a.createElement(o.K,null,s.a.t("Message")))),n.a.createElement(o.I,null,e.map((e,t)=>n.a.createElement(o.M,{key:"job-summary-messages-".concat(t)},n.a.createElement(o.J,null,e.uid),n.a.createElement(o.J,null,e.type),n.a.createElement(o.J,null,e.property),n.a.createElement(o.J,null,e.message))))))),Xt=({overviewStats:e,stats:t,messages:a})=>n.a.createElement("div",null,n.a.createElement(Ht,{importCount:e,id:s.a.t("Overview")}),n.a.createElement(Bt,{stats:t}),n.a.createElement(Gt,{messages:a})),Yt=e=>{if("ImportSummaries"==e.responseType){const{imported:t,deleted:a,ignored:l,updated:n,total:r}=e;return{imported:t,deleted:a,ignored:l,updated:n,total:r}}if(e.importCount){const{imported:t,deleted:a,ignored:l,updated:n}=e.importCount;return{imported:t,deleted:a,ignored:l,updated:n,total:t+a+l+n}}if(e.stats){const{imported:t,deleted:a,ignored:l,updated:n,total:r}=e.stats;return{imported:t,deleted:a,ignored:l,updated:n,total:r}}},Wt=({summary:e})=>{if(e.typeReports){const t=Object(u.a)({},e.stats,{imported:e.stats.created}),{stats:a,messages:l}=(e=>{let t=[];const a=[];return Object.keys(e).forEach(l=>{const{klass:n,objectReports:r,stats:c}=e[l];t=[...t,Object(u.a)({},c,{type:Kt(n)})],r&&r.forEach(e=>{const{uid:t,errorReports:l}=e;l&&l.forEach(e=>{a.push({uid:t,type:Kt(e.mainKlass),property:e.errorProperty,message:e.message})})})}),{stats:t,messages:a}})(e.typeReports);return n.a.createElement("div",{"data-test":"job-summary-summary"},n.a.createElement(Xt,{overviewStats:t,stats:a,messages:l}))}const t=Yt(e),a=n.a.createElement(Ht,{importCount:t,status:e.status,description:e.description,conflicts:e.conflicts,id:s.a.t("Overview")}),l="ImportSummaries"==e.responseType&&e.importSummaries?e.importSummaries.map((e,t)=>{const a=Yt(e);return n.a.createElement(Ht,{key:"single-summary-".concat(t),importCount:a,status:e.status,description:e.description,conflicts:e.conflicts,id:"".concat(t+1)})}):null;return n.a.createElement("div",{"data-test":"job-summary-summary"},a,n.a.createElement("div",{className:zt.a.rest,"data-test":"job-summary-summary-rest"},l))},Zt=e=>e instanceof File?e.name:Array.isArray(e)?e.map(e=>Zt(e)).join(","):e instanceof Object?e.label:"".concat(e),$t=({details:e})=>n.a.createElement(jt,{label:"".concat(s.a.t("Job details")),dataTest:"job-summary-job-details",name:"details"},n.a.createElement(o.H,null,n.a.createElement(o.L,null,n.a.createElement(o.N,null,n.a.createElement(o.K,null,s.a.t("Key")),n.a.createElement(o.K,null,s.a.t("Value")))),n.a.createElement(o.I,null,Object.keys(e).map(t=>n.a.createElement(o.M,{key:"job-summary-job-details-".concat(t)},n.a.createElement(o.J,null,t),n.a.createElement(o.J,null,Zt(e[t]))))))),Qt=({jobDetails:e,task:t,showFileDetails:a})=>n.a.createElement("div",{className:Pt.a.header},n.a.createElement("h3",{className:Pt.a.title},"".concat(s.a.t("Job summary"))),a&&n.a.createElement("span",{className:Pt.a.taskDetails},n.a.createElement("span",{"data-test":"job-summary-filename"},e.files[0].name)," ","-"," ",n.a.createElement("span",{"data-test":"job-summary-date"},H(t.created)," "))),ea=({jobDetails:e,task:t})=>n.a.createElement("div",{className:Pt.a.tags,"data-test":"job-summary-tags"},t.completed?n.a.createElement(o.O,{positive:!0},s.a.t("Completed")):n.a.createElement(o.O,{neutral:!0},s.a.t("In progress")),t.error&&n.a.createElement(o.O,{negative:!0,bold:!0},s.a.t("Error")),t.summary&&t.summary.conflicts&&n.a.createElement(o.O,{negative:!0},s.a.t("Conflicts")),e.dryRun&&n.a.createElement(o.O,{neutral:!0,bold:!0},s.a.t("Dry run"))),ta=({task:e,showFileDetails:t=!0,showJobDetails:a=!1,dataTest:l})=>{if(!e)return null;const{jobDetails:r}=e;return n.a.createElement("div",{className:Pt.a.container,"data-test":l},n.a.createElement(Qt,{jobDetails:r,task:e,showFileDetails:t}),n.a.createElement(ea,{jobDetails:r,task:e}),n.a.createElement(o.l,null),e.completed&&e.summary&&n.a.createElement(Wt,{summary:e.summary}),n.a.createElement("div",{className:Pt.a.events},n.a.createElement(Lt,{events:e.events})),a&&n.a.createElement("div",{className:Pt.a.jobDetails},n.a.createElement($t,{details:e.jobDetails})))},aa=({task:e,dataTest:t})=>e?n.a.createElement("div",{"data-test":t},n.a.createElement(ra,{label:s.a.t("View summary of recently started import job"),dataTest:"".concat(t,"-MoreOptions")},n.a.createElement(ta,{task:e,dataTest:"".concat(t,"-JobSummary")}))):null;var la=a(191),na=a.n(la);const ra=({children:e,initiallyVisible:t=!1,label:a=s.a.t("more options"),dataTest:r="interaction-more-options"})=>{const[c,o]=Object(l.useState)(!t);return n.a.createElement("div",{className:na.a.container,"data-test":r},n.a.createElement("div",{className:na.a.header,onClick:()=>{o(!c)},"data-test":"".concat(r,"-header")},c?n.a.createElement(T,null):n.a.createElement(f,null),a),n.a.createElement("div",{className:na.a.children,"data-test":"".concat(r,"-children")},!c&&e))},ca=({name:e,label:t,dataTest:a})=>{const{baseUrl:r}=Object(p.b)(),[c,o]=Object(l.useState)(!0),[i,m]=Object(l.useState)([]),[d,u]=Object(l.useState)(void 0);Object(l.useEffect)(()=>{Y("".concat(r,"/api/"),"organisationUnitAttribute").then(e=>m(e)).catch(e=>u(e)),o(!1)},[]);const E=d&&"".concat(s.a.t("Something went wrong when loading the additional organisation unit ID schemes")," : ").concat(d.message),v=[...de,...i];return n.a.createElement(Ic,{name:e,label:t,options:v,dataTest:a,loading:c,validationText:E,error:!!d,dense:!0})},sa=({list:e,select:t,selected:a,multiSelect:l,onOpen:r,onClose:c,dataTest:s})=>{const i=(m,d=0)=>Array.isArray(e)?m.map(({open:e,label:m,value:u,children:p,hasChildren:E})=>{const v=l?n.a.createElement(o.e,{name:u,value:u,label:m,checked:a.includes(u),onChange:()=>t(u),dataTest:"".concat(s,"-").concat(u,"-select")}):n.a.createElement(o.B,{name:u,value:u,label:m,checked:a.includes(u),onChange:()=>t(u),dataTest:"".concat(s,"-").concat(u,"-select")});return n.a.createElement(o.A,{key:"node-".concat(u),open:e,label:m,component:v,value:u,onOpen:()=>r(u,p),onClose:()=>c(u,p),dataTest:"".concat(s,"-").concat(u)},E&&0==p.length?n.a.createElement("span",null,"placeholder"):null,p?i(p,d+1):null)}):null;return 0==e.length?null:n.a.createElement("div",{"data-test":s},i(e))};var oa=a(192),ia=a.n(oa);const ma={roots:{resource:"organisationUnits",params:{filter:"level:eq:1",fields:"id,path,displayName,children::isNotEmpty",paging:"false"}}},da={units:{resource:"organisationUnits",id:({id:e})=>"".concat(e),params:{fields:"children[id,displayName,path,children::isNotEmpty]",paging:"false"}}},ua=({label:e,selected:t,setSelected:a,meta:r,dataTest:c,multiSelect:i=!0})=>{const[m,d]=Object(l.useState)([]),[u,E]=Object(l.useState)(void 0),{loading:v,engine:b}=Object(p.d)(ma,{onComplete:e=>{const t=e.roots.organisationUnits,a=h(t);d(a)},onError:e=>{E(e),console.error("OrgUnitTree error: ",e)}}),h=e=>e.map(({id:e,path:t,displayName:a,children:l})=>({open:!1,id:e,value:t,label:a,children:[],hasChildren:l})),g=e=>{const t=e.split("/").filter(e=>0!=e.length),a=[...m];let l=a;t.forEach(t=>{l=l.find(e=>e.id==t),l.value==e?l.open=!l.open:l=l.children}),d(a)},y=!v&&!u;return n.a.createElement(jt,{label:e,dataTest:c},n.a.createElement("div",{className:ia.a.container},v&&n.a.createElement(o.i,{dataTest:"".concat(c,"-loading")}),u&&n.a.createElement("div",{"data-test":"".concat(c,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the organisation units!")),n.a.createElement("p",null,u.message)),y&&n.a.createElement(sa,{selected:t,select:e=>{if(i){const l=!t.includes(e);a(0==l?t.filter(t=>t!=e):[...t,e])}else a([e])},multiSelect:i,onOpen:(e,t)=>{if(0==t.length){const t=K(e);b.query(da,{variables:{id:t},onComplete:t=>{((e,t)=>{const a=h(t);a.sort((e,t)=>e.label.localeCompare(t.label));const l=e.split("/").filter(e=>0!=e.length),n=[...m];let r=n;l.forEach(t=>{r=r.find(e=>e.id==t),r.value==e?(r.children=a,r.open=!0):r=r.children}),d(n)})(e,t.units.children)},onError:e=>{E(e),console.error("OrgUnitTree onOpen error: ",e)}})}else g(e)},onClose:e=>{g(e)},list:m,dataTest:"".concat(c,"-tree")}),(r.touched||!r.pristine)&&r.error&&n.a.createElement(o.o,{error:!0},r.error)))},pa=e=>0==e.length?s.a.t("At least one organisation unit must be selected"):void 0,Ea=e=>1!=e.length?s.a.t("One organisation unit must be selected"):void 0,va=e=>{let{input:{value:t,onChange:a},meta:l}=e,r=Object(lt.a)(e,["input","meta"]);return n.a.createElement(ua,Object.assign({meta:l,selected:t,setSelected:a},r))},ba=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:va,name:t,validate:a},l))};var ha=a(193),ga=a.n(ha);const ya=({title:e,desc:t,icon:a,summaryTask:l,showFullSummaryTask:r=!1,children:c,loading:s=!1,dataTest:i})=>{const m="number"==typeof s?n.a.createElement(o.q,{amount:s}):n.a.createElement(o.i,null);return n.a.createElement("div",{className:ga.a.container,"data-test":i},n.a.createElement("div",{className:ga.a.header},n.a.createElement("span",{className:ga.a.iconAndTitle},n.a.createElement("span",{className:ga.a.icon},a),n.a.createElement("span",{className:ga.a.title},e)),n.a.createElement("p",{className:ga.a.desc},t)),l&&n.a.createElement(o.d,{className:ga.a.preBody},n.a.createElement("div",{className:ga.a.content},r?n.a.createElement(ta,{task:l,dataTest:"job-summary-container"}):n.a.createElement(aa,{task:l,dataTest:"mini-job-summary-container"}))),n.a.createElement(o.d,null,!!s&&n.a.createElement(o.j,null,m),n.a.createElement("div",{className:ga.a.content},c)))},Sa={programs:{resource:"programs",params:{fields:"id,displayName",paging:"false"}}},Ta=({label:e,selected:t,setSelected:a,meta:r,dataTest:c,multiSelect:i,withFilter:m,withActions:d,autoSelectFirst:u})=>{const[E,v]=Object(l.useState)([]),{error:b,loading:h}=Object(p.d)(Sa,{onComplete:e=>{const t=e.programs.programs.map(({id:e,displayName:t})=>({value:e,label:t}));v(t),u&&a([t[0].value])},onError:e=>{console.error("ProgramPicker error: ",e)}}),g=!h&&!b;return n.a.createElement(jt,{label:e,dataTest:c},h&&n.a.createElement(o.i,{dataTest:"".concat(c,"-loading")}),b&&n.a.createElement("div",{"data-test":"".concat(c,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the programs!")),n.a.createElement("p",null,b.message)),g&&n.a.createElement(Cc,{name:"programPicker",label:s.a.t("Filter programs by name"),selected:t,setSelected:a,multiSelect:i,list:E,withFilter:m,withActions:d,dataTest:"".concat(c,"-list")}),(r.touched||!r.pristine)&&r.error&&n.a.createElement(o.o,{error:!0},r.error))};Ta.defaultProps={multiSelect:!1,withFilter:!0,withActions:!1,autoSelectFirst:!0};const fa=e=>0==e.length?s.a.t("At least one program must be selected"):void 0,Oa=e=>1!=e.length?s.a.t("One program must be selected"):void 0,ja=e=>{let{input:{value:t,onChange:a},meta:l}=e,r=Object(lt.a)(e,["input","meta"]);return n.a.createElement(Ta,Object.assign({meta:l,selected:t,setSelected:a},r))},wa=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:ja,name:t,validate:a},l))},ka=({name:e,label:t,selectedPrograms:a,form:r,validator:c,dataTest:o})=>{const i=a.length>0?a[0]:void 0,{loading:m,error:d,validationText:u,programStages:E}=((e,t)=>{const a=Object(p.c)(),[n,r]=Object(l.useState)(void 0),[c,o]=Object(l.useState)(!0),[i,m]=Object(l.useState)([]);return Object(l.useEffect)(()=>{e?(o(!0),t(void 0)):o(!1),e&&a.query(C,{variables:{id:e},onComplete:e=>{const a=e.data.programStages.map(e=>({value:e.id,label:e.displayName}));m([{value:"",label:U},...a]),t({value:"",label:U}),o(!1)},onError:e=>{r(e),console.error("useProgramStages error: ",e)}})},[e]),{loading:c,error:n,validationText:n&&"".concat(s.a.t("Something went wrong when loading the program stages")," : ").concat(n.message),programStages:i}})(i,t=>r.change(e,t));return n.a.createElement(Ic,{name:e,loading:m,label:t,validate:c,dataTest:o,options:E,validationText:u,error:!!d,dense:!0})};var Da=a(194),Aa=a.n(Da);const Na=({name:e,label:t,options:a,checked:l,setValue:r,vertical:c,dataTest:s})=>{const i=e=>({value:t})=>r({value:t,label:e});return n.a.createElement(jt,{label:t,dataTest:s,name:e},n.a.createElement("div",{className:c?void 0:Aa.a.inputs},a.map(t=>n.a.createElement("div",{key:t.value},n.a.createElement(o.B,{className:Aa.a.radio,name:e,value:t.value,label:t.label,checked:t.value==l.value,onChange:i(t.label),dataTest:"".concat(s,"-").concat(t.value)}),t.help&&n.a.createElement(o.o,null,t.help)))))},Ia=e=>{let{input:{value:t,onChange:a},meta:{error:l},inputName:r}=e,c=Object(lt.a)(e,["input","meta","inputName"]);return n.a.createElement(Na,Object.assign({name:r,error:l,checked:t,setValue:a},c))},Ma=e=>{let{name:t}=e,a=Object(lt.a)(e,["name"]);return n.a.createElement(nt.a,Object.assign({component:Ia,name:t,inputName:t},a))};var _a=a(165);const Ca=s.a.t("File"),Ua=e=>e&&0!=e.length?void 0:s.a.t("Please select a file"),xa=()=>n.a.createElement(gt,{name:"files",label:Ca,validator:Ua,dataTest:"input-file-upload"}),Ra=({form:e})=>n.a.createElement(Nt,{form:e,dryRunDataTest:"input-dry-run",importDataTest:"input-import-submit",dataTest:"input-import-button-strip"}),Fa=({alerts:e})=>n.a.createElement(Tt,{alerts:e,dataTest:"input-form-alerts"}),Pa=s.a.t("Format"),La=({availableFormats:e})=>n.a.createElement(Ma,{name:"format",label:Pa,options:e,dataTest:"input-format"}),Ja=s.a.t("First row is header"),za=({show:e,value:t})=>e&&n.a.createElement(es,{name:"firstRowIsHeader",label:Ja,value:t,dataTest:"input-first-row-is-header"}),Va=s.a.t("Object"),Ka=({form:e,prevValue:t,show:a=!0})=>{const{loading:r,error:c,validationText:o,classKeys:i}=((e,t)=>{const[a,n]=Object(l.useState)([]),{loading:r,error:c}=Object(p.d)(x,{onComplete:a=>{n(a.keys.map(e=>({value:e,label:e}))),e(t||{value:a.keys[0],label:a.keys[0]})},onError:e=>{console.error("useClassKeys error: ",e)}});return{loading:r,error:c,validationText:c&&"".concat(s.a.t("Something went wrong when loading the class keys")," : ").concat(c.message),classKeys:a}})(t=>e.change("classKey",t),t);return a&&n.a.createElement(Ic,{name:"classKey",label:Va,options:i,loading:r,dataTest:"input-class-key",validationText:o,error:!!c,filterable:!0,dense:!0})},qa=s.a.t("Strategy"),Ha=()=>n.a.createElement(Ma,{name:"strategy",label:qa,options:ve,dataTest:"input-strategy"}),Ba=s.a.t("Preheat cache"),Ga=s.a.t("Faster for large imports"),Xa=({value:e})=>n.a.createElement(es,{name:"preheatCache",label:Ba,value:e,dataTest:"input-preheat-cache",help:Ga}),Ya=s.a.t("Skip audit"),Wa=s.a.t("Improves performance at the cost of ability to audit changes"),Za=({value:e})=>n.a.createElement(es,{name:"skipAudit",label:Ya,value:e,dataTest:"input-has-authority-to-skip-audit",help:Wa}),$a=s.a.t("Skip exisiting check"),Qa=s.a.t("Faster, but unsafe"),el=({value:e})=>n.a.createElement(es,{name:"skipExistingCheck",label:$a,value:e,dataTest:"input-skip-exisiting-check",help:Qa}),tl=s.a.t("Identifier"),al=()=>n.a.createElement(Ma,{name:"identifier",label:tl,options:he,dataTest:"input-identifier"}),ll=s.a.t("Import report mode"),nl=()=>n.a.createElement(Ma,{name:"importReportMode",label:ll,options:ge,dataTest:"input-import-report-mode"}),rl=s.a.t("Preheat mode"),cl=()=>n.a.createElement(Ma,{name:"preheatMode",label:rl,options:ye,dataTest:"input-preheat-mode"}),sl=s.a.t("Import strategy"),ol=()=>n.a.createElement(Ma,{name:"importStrategy",label:sl,options:be,dataTest:"input-import-strategy"}),il=s.a.t("Atomic mode"),ml=()=>n.a.createElement(Ma,{name:"atomicMode",label:il,options:Se,dataTest:"input-atomic-mode"}),dl=s.a.t("Merge mode"),ul=()=>n.a.createElement(Ma,{name:"mergeMode",label:dl,options:Te,dataTest:"input-merge-mode"}),pl=s.a.t("Flush mode"),El=()=>n.a.createElement(Ma,{name:"flushMode",label:pl,options:fe,dataTest:"input-flush-mode"}),vl=s.a.t("Inclusion strategy"),bl=()=>n.a.createElement(Ma,{name:"inclusionStrategy",label:vl,options:Oe,dataTest:"input-inclusion-strategy"}),hl=s.a.t("Skip sharing"),gl=({value:e})=>n.a.createElement(es,{name:"skipSharing",label:hl,value:e,dataTest:"input-skip-sharing"}),yl=s.a.t("Skip validation"),Sl=({value:e})=>n.a.createElement(es,{name:"skipValidation",label:yl,value:e,dataTest:"input-skip-validation"}),Tl=s.a.t("Async"),fl=({value:e})=>n.a.createElement(es,{name:"isAsync",label:Tl,value:e,dataTest:"input-is-async"}),Ol=s.a.t("Organisation unit"),jl=({multiSelect:e=!0})=>{const t=e?pa:Ea,a=Object(ht.c)(ht.d,t);return n.a.createElement(ba,{name:"selectedOrgUnits",validator:a,multiSelect:e,label:Ol,dataTest:"input-org-unit-tree"})},wl=s.a.t("Data sets"),kl=({multiSelect:e=!0})=>{const t=e?rt:ct,a=Object(ht.c)(ht.d,t);return n.a.createElement(ot,{name:"selectedDataSets",validator:a,multiSelect:e,label:wl,dataTest:"input-data-set-picker"})},Dl=s.a.t("Programs"),Al=e=>{let{multiSelect:t,show:a}=e,l=Object(lt.a)(e,["multiSelect","show"]);const r=t?fa:Oa,c=Object(ht.c)(ht.d,r);return a&&n.a.createElement(wa,Object.assign({name:"selectedPrograms",multiSelect:t,validator:c,withActions:!1,label:Dl,dataTest:"input-program-picker"},l))};Al.defaultProps={multiSelect:!1,show:!0};const Nl=s.a.t("Include children"),Il=({value:e})=>n.a.createElement(es,{name:"includeChildren",label:Nl,value:e,dataTest:"input-include-children"}),Ml=s.a.t("Include deleted"),_l=({value:e})=>n.a.createElement(es,{name:"includeDeleted",label:Ml,value:e,dataTest:"input-include-deleted"}),Cl=s.a.t("Compression"),Ul=({availableCompressions:e})=>n.a.createElement(Ma,{name:"compression",label:Cl,options:e,dataTest:"input-compression"}),xl=s.a.t("Inclusion"),Rl=()=>n.a.createElement(Ma,{name:"inclusion",label:xl,options:Ee,dataTest:"input-inclusion"}),Fl=s.a.t("Start date"),Pl=Object(ht.c)(ht.d,dt),Ll=()=>n.a.createElement(vt,{name:"startDate",validator:Pl,label:Fl,dataTest:"input-start-date"}),Jl=s.a.t("End date"),zl=Object(ht.c)(ht.d,dt),Vl=()=>n.a.createElement(vt,{name:"endDate",validator:zl,label:Jl,dataTest:"input-end-date"}),Kl=s.a.t("Export"),ql=()=>n.a.createElement(o.b,{primary:!0,type:"submit",dataTest:"input-export-submit"},Kl),Hl=Object(ht.c)(ht.d,e=>e?void 0:s.a.t("One program stage must be selected")),Bl=s.a.t("Program stage"),Gl=e=>n.a.createElement(ka,Object.assign({name:"programStage",label:Bl,validator:Hl,dataTest:"input-program-stage-select"},e));function Xl(e,t){return t.reduce((t,{name:a,displayName:l})=>t||((t=>e===t.toLowerCase())(a)?l:t),"")}function Yl(e,t){return t.reduce((t,{name:a})=>{if(t)return t;return(t=>t.includes(e)&&0===t.indexOf(e))(a.toLowerCase())?(l=a.substr(0,e.length).replace(/([A-Z]+)/g," $1"))[0].toUpperCase()+l.substr(1):t;var l},"")}const Wl=e=>(e=>Object.keys(e).reduce((t,a)=>{const l=e[a];return 1===l.length?Object(u.a)({},t,{other:[...t.other,l[0]]}):Object(u.a)({},t,{[a]:l})},{other:[]}))((e=>e.reduce((e,t)=>{const{group:a}=t;return Object(u.a)({},e,{[a]:e[a]?[...e[a],t]:[t]})},{}))(e)),Zl=e=>Object.entries(e).reduce((e,[t,a])=>{const l=function(e,t){const a=e.toLowerCase();return"oauth2"===a||"other"===a?e:Xl(a,t)||Yl(a,t)||e[0].toUpperCase()+e.substr(1)}(t,a);return Object(u.a)({},e,{[t]:l})},{}),$l=e=>{const t=e.split(".");return t.pop(),e.includes(".dhis")||t.pop(),t[t.length-1].replace(/(.)([A-Z])/g,"$1 $2")};var Ql=a(175),en=a.n(Ql);const tn=({label:e,schemas:t,toggleSchema:a,dataTest:l})=>n.a.createElement("div",{className:en.a.group,"data-test":l},n.a.createElement("span",{className:en.a.formLabel},e),n.a.createElement("div",{className:en.a.schema},t.map((e,t)=>n.a.createElement("div",{key:e.name},n.a.createElement(o.e,{label:e.label,name:"schemas.".concat(e.name),value:"schemas.".concat(e.name),checked:e.checked,onChange:()=>a(t)}))))),an={schemas:{resource:"schemas",params:{fields:["metadata","collectionName","displayName","klass"]}}},ln=({excludeSchemas:e,setCheckedSchemas:t,meta:a,checkedByDefault:r,dataTest:c})=>{const[i,m]=Object(l.useState)(void 0),[d,E]=Object(l.useState)(void 0),[v,b]=Object(l.useState)(void 0),{error:h,loading:g}=Object(p.d)(an,{onComplete:t=>{const a=t.schemas.schemas,l=((e,t)=>e.map(e=>({checked:t,label:e.displayName,name:e.collectionName,group:$l(e.klass)})))(((e,t)=>t.filter(t=>t.metadata&&!e.has(t.collectionName)))(e,a),r),n=Wl(l);m(n),b((e=>{const t=Object.keys(e);return t.sort(),t})(n)),E(Zl(n)),y(n)},onError:e=>{console.error("Schemas error: ",e)}}),y=e=>{t(Object.keys(e).reduce((t,a)=>[...t,...e[a].filter(e=>e.checked).map(e=>e.name)],[]))},S=e=>()=>{const t=Object.keys(i).reduce((t,a)=>Object(u.a)({},t,{[a]:i[a].reduce((t,a)=>[...t,Object(u.a)({},a,{checked:e})],[])}),{});m(t),y(t)},T=!g&&!h;return n.a.createElement("div",{className:en.a.container,"data-test":c},g&&n.a.createElement(o.i,{dataTest:"".concat(c,"-loading")}),h&&n.a.createElement("div",{"data-test":"".concat(c,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the schemas!")),n.a.createElement("p",null,h.message)),T&&n.a.createElement(n.a.Fragment,null,n.a.createElement(o.c,null,n.a.createElement(o.b,{onClick:S(!0),dataTest:"".concat(c,"-select-all")},s.a.t("Select All")),n.a.createElement(o.b,{onClick:S(!1),dataTest:"".concat(c,"-select-none")},s.a.t("Select None"))),n.a.createElement("div",{className:en.a.formControl},v.map(e=>{const t=d[e];return n.a.createElement(tn,{key:t,label:t,schemas:i[e],toggleSchema:(a=e,e=>{const t=[...i[a]];t[e]=Object(u.a)({},t[e],{checked:!t[e].checked});const l=Object(u.a)({},i,{[a]:t});m(l),y(l)})});var a})),(a.touched||!a.pristine)&&a.error&&n.a.createElement(o.o,{error:!0},a.error)))},nn=e=>{let{input:{onChange:t},meta:a}=e,l=Object(lt.a)(e,["input","meta"]);return n.a.createElement(ln,Object.assign({meta:a,setCheckedSchemas:t},l))},rn=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:nn,name:t,validate:a},l))},cn=Object(ht.c)(ht.d,e=>0==e.length?s.a.t("At least one schema must be selected"):void 0),sn=new Set(["analyticsTableHooks","charts","constants","dataElementDimensions","dataEntryForms","dataSetNotificationTemplates","dataStores","documents","eventCharts","eventReports","icons","jobConfigurations","messageConversations","metadataVersions","minMaxDataElements","oAuth2Clients","programDataElements","programNotificationTemplates","pushAnalysis","reportTables","reportingRates","reports","sections","smsCommands","sqlViews","trackedEntityInstanceFilters","validationNotificationTemplates"]),on=()=>n.a.createElement(rn,{name:"checkedSchemas",excludeSchemas:sn,validator:cn,checkedByDefault:!0,dataTest:"input-schemas"}),mn=s.a.t("Object type"),dn=()=>n.a.createElement(Ic,{name:"objectType",label:mn,options:ie,filled:!0,initialFocus:!0,dataTest:"input-object-type"}),un=s.a.t("Object"),pn=Object(ht.c)(ht.d,e=>e?void 0:s.a.t("One object must be selected")),En=({objectType:e,form:t})=>{const{loading:a,error:r,validationText:c,objects:o}=((e,t)=>{const a=Object(p.c)(),[n,r]=Object(l.useState)(void 0),[c,o]=Object(l.useState)(!0),[i,m]=Object(l.useState)([]);return Object(l.useEffect)(()=>{o(!0),t(void 0),a.query({data:{resource:e.value,fields:"id,displayName",params:{paging:"false"}}},{onComplete:a=>{const l=a.data[e.value].map(e=>({value:e.id,label:e.displayName}));m(l),t(l[0]),o(!1)},onError:e=>{r(e),console.error("useObjects error: ",e)}})},[e]),{loading:c,error:n,validationText:n&&"".concat(s.a.t("Something went wrong when loading the objects")," : ").concat(n.message),objects:i}})(e,e=>t.change("object",e));return n.a.createElement(Ic,{loading:a,name:"object",label:un,options:o,validate:pn,dataTest:"input-object-select",validationText:c,error:!!r,filterable:!0,dense:!0})},vn=s.a.t("Data element ID scheme"),bn=()=>n.a.createElement(et,{name:"dataElementIdScheme",label:vn,dataTest:"input-data-element-id-scheme"}),hn=s.a.t("Event ID scheme"),gn=()=>n.a.createElement(bt,{name:"eventIdScheme",label:hn,dataTest:"input-event-id-scheme"}),yn=s.a.t("ID scheme"),Sn=()=>n.a.createElement(wt,{name:"idScheme",label:yn,dataTest:"input-id-scheme"}),Tn=s.a.t("Organisation unit ID scheme"),fn=()=>n.a.createElement(ca,{name:"orgUnitIdScheme",label:Tn,dataTest:"input-org-unit-id-scheme"}),On=e=>e.includes("ALL")||e.includes("F_SKIP_DATA_IMPORT_AUDIT"),jn=s.a.t("Organisation unit selection mode"),wn=()=>{const e=Object(l.useContext)(i);const t=!!e&&e.authorities.includes("ALL")?je:je.filter(({value:e})=>"ALL"!=e);return n.a.createElement(Ma,{name:"ouMode",label:jn,options:t,dataTest:"input-ouMode",vertical:!0})},kn=s.a.t("Filter by"),Dn=()=>n.a.createElement(Ma,{name:"teiTypeFilter",label:kn,options:we,dataTest:"input-tei-type-filter"}),An=s.a.t("Program status"),Nn=({show:e})=>e&&n.a.createElement(Ma,{name:"programStatus",label:An,options:ke,dataTest:"input-program-status"}),In=s.a.t("Follow up status"),Mn=({show:e})=>e&&n.a.createElement(Ma,{name:"followUpStatus",label:In,options:De,dataTest:"input-follow-up-status"}),_n=s.a.t("Program start date"),Cn=Object(ht.c)(mt),Un=({show:e})=>e&&n.a.createElement(vt,{name:"programStartDate",validator:Cn,label:_n,dataTest:"input-program-start-date"}),xn=s.a.t("Program end date"),Rn=Object(ht.c)(mt),Fn=({show:e})=>e&&n.a.createElement(vt,{name:"programEndDate",validator:Rn,label:xn,dataTest:"input-program-end-date"}),Pn=e=>0==e.length?s.a.t("At least one tracked entity type must be selected"):void 0,Ln=e=>1!=e.length?s.a.t("One tracked entity type must be selected"):void 0,Jn=e=>{let{input:{value:t,onChange:a},meta:l}=e,r=Object(lt.a)(e,["input","meta"]);return n.a.createElement(ls,Object.assign({meta:l,selected:t,setSelected:a},r))},zn=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:Jn,name:t,validate:a},l))},Vn=s.a.t("Tracked entity types"),Kn=e=>{let{multiSelect:t,show:a}=e,l=Object(lt.a)(e,["multiSelect","show"]);const r=t?Pn:Ln,c=Object(ht.c)(ht.d,r);return a&&n.a.createElement(zn,Object.assign({name:"selectedTETypes",multiSelect:t,validator:c,withActions:!1,label:Vn,dataTest:"input-te-type-picker"},l))};Kn.defaultProps={multiSelect:!1};const qn=s.a.t("Filter by last updated"),Hn=()=>n.a.createElement(Ma,{name:"lastUpdatedFilter",label:qn,options:Ae,dataTest:"input-last-updated-filter"}),Bn=s.a.t("Last updated start date"),Gn=Object(ht.c)(mt),Xn=({show:e})=>e&&n.a.createElement(vt,{name:"lastUpdatedStartDate",validator:Gn,label:Bn,dataTest:"input-last-updated-start-date"}),Yn=s.a.t("Last updated end date"),Wn=Object(ht.c)(mt),Zn=({show:e})=>e&&n.a.createElement(vt,{name:"lastUpdatedEndDate",validator:Wn,label:Yn,dataTest:"input-last-updated-end-date"}),$n=/^(?!$)(\d+d)?(\d+h)?(\d+m)?(\d+s)?$/,Qn="".concat(s.a.t("Format"),": 00d00h00m00s"),er=({input:{value:e,onChange:t},meta:{error:a},inputName:l,label:r,dataTest:c})=>n.a.createElement(jt,{label:r,dataTest:c},n.a.createElement(o.p,{name:l,value:e,onChange:({value:e})=>{t(e)},inputWidth:"200px",error:!!a,validationText:a,helpText:Qn,placeholder:"100d5h30m"})),tr=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:er,name:t,inputName:t,validate:a},l))},ar=s.a.t("Last updated duration"),lr=Object(ht.c)(ht.d,e=>e.match($n)?void 0:s.a.t("Invalid duration")),nr=({show:e})=>e&&n.a.createElement(tr,{name:"lastUpdatedDuration",validator:lr,label:ar,dataTest:"input-last-updated-duration"}),rr=s.a.t("Assigned user mode"),cr=()=>n.a.createElement(Ma,{name:"assignedUserMode",label:rr,options:Ne,dataTest:"input-assigned-user-mode"}),sr=e=>0==e.length?s.a.t("At least one user must be selected"):void 0,or=e=>1!=e.length?s.a.t("One user must be selected"):void 0,ir=e=>{let{input:{value:t,onChange:a},meta:l}=e,r=Object(lt.a)(e,["input","meta"]);return n.a.createElement(rs,Object.assign({meta:l,selected:t,setSelected:a},r))},mr=e=>{let{name:t,validator:a}=e,l=Object(lt.a)(e,["name","validator"]);return n.a.createElement(nt.a,Object.assign({component:ir,name:t,validate:a},l))},dr=s.a.t("Users"),ur=e=>{let{multiSelect:t,show:a}=e,l=Object(lt.a)(e,["multiSelect","show"]);const r=t?sr:or,c=Object(ht.c)(ht.d,r);return a&&n.a.createElement(mr,Object.assign({name:"selectedUsers",multiSelect:t,autoSelectFirst:!1,validator:c,withActions:!0,label:dr,dataTest:"input-user-picker"},l))};ur.defaultProps={multiSelect:!0};const pr=s.a.t("Include all attributes"),Er=({value:e})=>n.a.createElement(es,{name:"includeAllAttributes",label:pr,value:e,dataTest:"input-include-all-attributes"}),vr="FINAL_FORM/form-error",br=e=>{return{classKey:(t=e.format,a=e.classKey,"csv"!=t.value||a?void 0:s.a.t("A class key must be selected"))};var t,a},hr=s.a.t("Metadata import"),gr=s.a.t("Import metadata like data elements and organisation units using the DXF 2 format."),yr=n.a.createElement(v,null),Sr=()=>{const{tasks:{metadata:e},addTask:t}=Object(l.useContext)(m),a=Object(_a.g)().query,r=ee(a,e),c=(e=>({files:e.files,format:e.format||Ie,identifier:e.identifier||Le,importReportMode:e.importReportMode||Je,preheatMode:e.preheatMode||ze,importStrategy:e.importStrategy||Ve,firstRowIsHeader:!!e.firstRowIsHeader,atomicMode:e.atomicMode||Ke,mergeMode:e.mergeMode||qe,flushMode:e.flushMode||He,inclusionStrategy:e.inclusionStrategy||Be,skipSharing:!!e.skipSharing,skipValidation:!!e.skipValidation,isAsync:!e.isAsync}))(r),[s,o]=Object(l.useState)(0),[i,E]=Object(l.useState)(!1),{baseUrl:v}=Object(p.b)(),b=(({baseUrl:e,setProgress:t,addTask:a,setShowFullSummaryTask:l})=>async n=>{const{dryRun:r,files:c,format:s,identifier:o,importReportMode:i,preheatMode:m,importStrategy:d,atomicMode:p,mergeMode:E,flushMode:v,skipSharing:b,skipValidation:h,inclusionStrategy:g,isAsync:y,firstRowIsHeader:S,classKey:T}=n,f="".concat(e,"/api/"),O=["importMode=".concat(r?"VALIDATE":"COMMIT"),"identifier=".concat(o.value),"importReportMode=".concat(i.value),"preheatMode=".concat(m.value),"importStrategy=".concat(d.value),"atomicMode=".concat(p.value),"mergeMode=".concat(E.value),"flushMode=".concat(v.value),"skipSharing=".concat(b),"skipValidation=".concat(h),"inclusionStrategy=".concat(g.value),"async=".concat(y),"format=".concat(s.value),"csv"==s.value?"firstRowIsHeader=".concat(S,"&classKey=").concat(T.value):""].filter(e=>""!=e).join("&"),j="".concat(f).concat("metadata.json","?").concat(O);try{await $({url:j,file:c[0],format:s.value,type:"METADATA_IMPORT",setProgress:t,addEntry:(e,t)=>a("metadata",e,Object(u.a)({},t,{jobDetails:n}))})}catch(w){const e=br(n);return Object(u.a)({[vr]:[w]},e)}finally{l(!0)}})({baseUrl:v,setProgress:o,addTask:t,setShowFullSummaryTask:E});return n.a.createElement(ya,{title:hr,desc:gr,icon:yr,loading:s,dataTest:"page-import-metadata",summaryTask:d(e),showFullSummaryTask:i},n.a.createElement(nt.b,{onSubmit:b,initialValues:c,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,values:a,submitError:l})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(xa,null),n.a.createElement(La,{availableFormats:le}),n.a.createElement(za,{show:"csv"==a.format.value,value:a.firstRowIsHeader}),n.a.createElement(Ka,{show:"csv"==a.format.value,form:t,prevValue:r.classKey}),n.a.createElement(al,null),n.a.createElement(nl,null),n.a.createElement(cl,null),n.a.createElement(ol,null),n.a.createElement(ml,null),n.a.createElement(ul,null),n.a.createElement(ra,null,n.a.createElement(El,null),n.a.createElement(gl,{value:a.skipSharing}),n.a.createElement(Sl,{value:a.skipValidation}),n.a.createElement(fl,{value:a.isAsync}),n.a.createElement(bl,null)),n.a.createElement(Ra,{form:t}),n.a.createElement(Fa,{alerts:l}))}))},Tr=s.a.t("Metadata export"),fr=s.a.t("Export meta data like data elements and organisation units in the XML, JSON or CSV format."),Or=n.a.createElement(b,null),jr={checkedSchemas:[],format:Ie,compression:Me,skipSharing:!1},wr=()=>{const{baseUrl:e}=Object(p.b)(),t=(e=>t=>{const{checkedSchemas:a,format:l,compression:n,skipSharing:r}=t,c="".concat(e,"/api/"),s=n.value?"".concat(l.value,".").concat(n.value):l.value,o=a.map(e=>"".concat(e,"=true")).join("&"),i="skipSharing=".concat(r,"&download=true&").concat(o),m="".concat(c).concat("metadata",".").concat(s,"?").concat(i);Q(m)})(e);return n.a.createElement(ya,{title:Tr,desc:fr,icon:Or,dataTest:"page-export-metadata"},n.a.createElement(nt.b,{onSubmit:t,initialValues:jr,render:({handleSubmit:e,form:t,values:a})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(on,null),n.a.createElement(La,{availableFormats:le}),n.a.createElement(Ul,{availableCompressions:oe}),n.a.createElement(gl,{value:a.skipSharing}),n.a.createElement(ql,null))}))},kr=s.a.t("Metadata dependency export"),Dr=s.a.t("Export metadata like data sets and programs including related metadata objects in the XML or JSON format."),Ar=n.a.createElement(h,null),Nr={objectType:_e,object:void 0,format:Ie,compression:Me,skipSharing:!1},Ir=()=>{const{baseUrl:e}=Object(p.b)(),t=(e=>t=>{const{objectType:a,object:l,format:n,compression:r,skipSharing:c}=t,s="".concat(e,"/api/"),o="".concat(a.value,"/").concat(l.value,"/metadata"),i=r.value?"".concat(n.value,".").concat(r.value):n.value,m="skipSharing=".concat(c,"&download=true"),d="".concat(s).concat(o,".").concat(i,"?").concat(m);Q(d)})(e);return n.a.createElement(ya,{title:kr,desc:Dr,icon:Ar,dataTest:"page-export-metadata-dependency"},n.a.createElement(nt.b,{onSubmit:t,initialValues:Nr,render:({handleSubmit:e,form:t,values:a})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(dn,null),n.a.createElement(En,{objectType:a.objectType,form:t}),n.a.createElement(La,{availableFormats:ne}),n.a.createElement(Ul,{availableCompressions:oe}),n.a.createElement(gl,{value:a.skipSharing}),n.a.createElement(ql,null))}))};var Mr=a(195),_r=a.n(Mr);const Cr=()=>{const{jobOverview:e,updateJobOverview:t}=Object(l.useContext)(m);return n.a.createElement(ya,{title:Ur,desc:xr,icon:Rr,dataTest:"job-overview-page"},n.a.createElement("div",{className:_r.a.container},n.a.createElement(Rt,{activeTypes:e.activeTypes,setActiveTypes:e=>{t({activeTypes:e})},selectedJob:e.selectedJob,setSelectedJob:e=>{t({selectedJob:e})}})))},Ur=s.a.t("Job overview"),xr=s.a.t("An overview of all import jobs started this session."),Rr=n.a.createElement(O,null),Fr=s.a.t("GML import"),Pr=s.a.t("Import geographic data for organisation units using the GML format. GML is an XML grammar for expressing geographical features."),Lr=n.a.createElement(S,null),Jr=()=>{const{tasks:{gml:e},addTask:t}=Object(l.useContext)(m),a=Object(_a.g)().query,r=(e=>({files:e.files}))(ee(a,e)),[c,s]=Object(l.useState)(0),[o,i]=Object(l.useState)(!1),{baseUrl:E}=Object(p.b)(),v=(({baseUrl:e,setProgress:t,addTask:a,setShowFullSummaryTask:l})=>async n=>{const{dryRun:r,files:c}=n,s="".concat(e,"/api/"),o=["dryRun=".concat(r),"format=json"].join("&"),i="".concat(s).concat("metadata/gml.json","?").concat(o);try{await $({url:i,file:c[0],format:"gml",type:"GML_IMPORT",setProgress:t,addEntry:(e,t)=>a("gml",e,Object(u.a)({},t,{jobDetails:n}))})}catch(m){return{[vr]:[m]}}finally{l(!0)}})({baseUrl:E,setProgress:s,addTask:t,setShowFullSummaryTask:i});return n.a.createElement(ya,{title:Fr,desc:Pr,icon:Lr,loading:c,dataTest:"page-import-gml",summaryTask:d(e),showFullSummaryTask:o},n.a.createElement(nt.b,{onSubmit:v,initialValues:r,render:({handleSubmit:e,form:t,submitError:a})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(xa,null),n.a.createElement(Ra,{form:t}),n.a.createElement(Fa,{alerts:a}))}))},zr=s.a.t("Event import"),Vr=s.a.t("Import events for programs, stages and tracked entities using the DXF 2 format."),Kr=n.a.createElement(y,null),qr=()=>{const{tasks:{event:e},addTask:t}=Object(l.useContext)(m),a=Object(_a.g)().query,r=(e=>({files:e.files,format:e.format||Ie,dataElementIdScheme:e.dataElementIdScheme||Ce,orgUnitIdScheme:e.orgUnitIdScheme||Ue,eventIdScheme:e.eventIdScheme||Re,idScheme:e.idScheme||xe}))(ee(a,e)),[c,s]=Object(l.useState)(0),[o,i]=Object(l.useState)(!1),{baseUrl:E}=Object(p.b)(),v=(({baseUrl:e,setProgress:t,addTask:a,setShowFullSummaryTask:l})=>async n=>{const{dryRun:r,files:c,format:s,dataElementIdScheme:o,orgUnitIdScheme:i,eventIdScheme:m,idScheme:d}=n,p="".concat(e,"/api/"),E=["skipFirst=true","async=true","dryRun=".concat(r),"dataElementIdScheme=".concat(o.value),"orgUnitIdScheme=".concat(i.value),"eventIdScheme=".concat(m.value),"idScheme=".concat(d.value),"payloadFormat=".concat(s.value)].join("&"),v="".concat(p).concat("events.json","?").concat(E);try{await $({url:v,file:c[0],format:s.value,type:"EVENT_IMPORT",setProgress:t,addEntry:(e,t)=>a("event",e,Object(u.a)({},t,{jobDetails:n}))})}catch(b){return{[vr]:[b]}}finally{l(!0)}})({baseUrl:E,setProgress:s,addTask:t,setShowFullSummaryTask:i});return n.a.createElement(ya,{title:zr,desc:Vr,icon:Kr,loading:c,dataTest:"page-import-event",summaryTask:d(e),showFullSummaryTask:o},n.a.createElement(nt.b,{onSubmit:v,initialValues:r,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,submitError:a})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(xa,null),n.a.createElement(La,{availableFormats:le}),n.a.createElement(ra,null,n.a.createElement(gn,null),n.a.createElement(bn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null)),n.a.createElement(Ra,{form:t}),n.a.createElement(Fa,{alerts:a}))}))},Hr=e=>({startDate:ut(e.startDate,e.endDate),endDate:pt(e.endDate,e.startDate)}),Br=s.a.t("Event export"),Gr=s.a.t("Export event data for programs, stages and tracked entities in the DXF 2 format."),Xr=n.a.createElement(y,null),Yr=new Date,Wr={selectedOrgUnits:[],selectedPrograms:[],programStage:void 0,format:Ie,compression:Me,startDate:new Date(Yr.getFullYear(),Yr.getMonth()-3,Yr.getDate()),endDate:Yr,includeDeleted:!1,dataElementIdScheme:Ce,orgUnitIdScheme:Ue,idScheme:xe,inclusion:Fe},Zr=()=>{const{baseUrl:e}=Object(p.b)(),t=(e=>t=>{const{selectedOrgUnits:a,selectedPrograms:l,programStage:n,format:r,compression:c,startDate:s,endDate:o,includeDeleted:i,dataElementIdScheme:m,orgUnitIdScheme:d,idScheme:u,inclusion:p}=t,E="".concat(e,"/api/"),v=c.value?"".concat(r.value,".").concat(c.value):r.value,b="".concat("events",".").concat(v),h=["links=false","skipPaging=true","orgUnit=".concat(K(a[0])),"program=".concat(l[0]),"includeDeleted=".concat(i),"dataElementIdScheme=".concat(m.value),"orgUnitIdScheme=".concat(d.value),"idScheme=".concat(u.value),"attachment=".concat(b),"startDate=".concat(q(s)),"endDate=".concat(q(o)),"ouMode=".concat(p.value),"format=".concat(r.value),""!=n.value?"programStage=".concat(n.value):""].filter(e=>""!=e).join("&"),g="".concat(E).concat("events",".").concat(v,"?").concat(h);Q(g)})(e);return n.a.createElement(ya,{title:Br,desc:Gr,icon:Xr,dataTest:"page-export-data"},n.a.createElement(nt.b,{onSubmit:t,initialValues:Wr,validate:Hr,subscription:{values:!0},render:({handleSubmit:e,form:t,values:a})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(jl,{multiSelect:!1}),n.a.createElement(Al,{autoSelectFirst:!0}),n.a.createElement(Gl,{selectedPrograms:a.selectedPrograms,form:t}),n.a.createElement(Ll,null),n.a.createElement(Vl,null),n.a.createElement(La,{availableFormats:le}),n.a.createElement(Ul,{availableCompressions:oe}),n.a.createElement(ra,null,n.a.createElement(_l,{value:a.includeDeleted}),n.a.createElement(bn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null),n.a.createElement(Rl,null)),n.a.createElement(ql,null))}))},$r=s.a.t("Data import"),Qr=s.a.t("Import data values from ADX XML, DXF 2 XML, JSON, CSV or PDF files."),ec=n.a.createElement(g,null),tc=()=>{const{tasks:{data:e},addTask:t}=Object(l.useContext)(m),a=Object(_a.g)().query,r=(e=>({files:e.files,format:e.format||Ie,strategy:e.strategy||Pe,firstRowIsHeader:!!e.firstRowIsHeader,preheatCache:!!e.preheatCache,skipAudit:!!e.skipAudit,dataElementIdScheme:e.dataElementIdScheme||Ce,orgUnitIdScheme:e.orgUnitIdScheme||Ue,idScheme:e.idScheme||xe,skipExistingCheck:!!e.skipExistingCheck}))(ee(a,e)),[c,s]=Object(l.useState)(0),[o,i]=Object(l.useState)(!1),{baseUrl:E}=Object(p.b)(),v=(({baseUrl:e,setProgress:t,addTask:a,setShowFullSummaryTask:l})=>async n=>{const{dryRun:r,files:c,strategy:s,preheatCache:o,skipAudit:i,dataElementIdScheme:m,orgUnitIdScheme:d,idScheme:p,skipExistingCheck:E,format:v,firstRowIsHeader:b}=n,h="".concat(e,"/api/"),g=["async=true","dryRun=".concat(r),"strategy=".concat(s.value),"preheatCache=".concat(o),"skipAudit=".concat(i),"dataElementIdScheme=".concat(m.value),"orgUnitIdScheme=".concat(d.value),"idScheme=".concat(p.value),"skipExistingCheck=".concat(E),"format=".concat(v.value),"csv"==v?"firstRowIsHeader=".concat(b):""].filter(e=>""!=e).join("&"),y="".concat(h).concat("dataValueSets.json","?").concat(g);try{await $({url:y,file:c[0],format:v.value,type:"DATAVALUE_IMPORT",setProgress:t,addEntry:(e,t)=>a("data",e,Object(u.a)({},t,{jobDetails:n}))})}catch(S){return{[vr]:[S]}}finally{l(!0)}})({baseUrl:E,setProgress:s,addTask:t,setShowFullSummaryTask:i});return n.a.createElement(ya,{title:$r,desc:Qr,icon:ec,loading:c,dataTest:"page-import-data",summaryTask:d(e),showFullSummaryTask:o},n.a.createElement(nt.b,{onSubmit:v,initialValues:r,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,values:a,submitError:l})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(xa,null),n.a.createElement(La,{availableFormats:ce}),n.a.createElement(za,{show:"csv"==a.format.value,value:a.firstRowIsHeader}),n.a.createElement(Ha,null),n.a.createElement(Xa,{value:a.preheatCache}),n.a.createElement(ts,{pred:On},n.a.createElement(Za,{value:a.skipAudit})),n.a.createElement(ra,null,n.a.createElement(bn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null),n.a.createElement(el,{value:a.skipExistingCheck})),n.a.createElement(Ra,{form:t}),n.a.createElement(Fa,{alerts:l}))}))};var ac=a(176),lc=a.n(ac);const nc={sets:{resource:"dataValueSets",params:({dataElementIdScheme:e,orgUnitIdScheme:t,idScheme:a,includeDeleted:l,children:n,startDate:r,endDate:c,orgUnit:s,dataSet:o,format:i})=>({dataElementIdScheme:e,orgUnitIdScheme:t,idScheme:a,includeDeleted:l,children:n,startDate:r,endDate:c,orgUnit:s,dataSet:o,format:i})}},rc=e=>({startDate:ut(e.startDate,e.endDate),endDate:pt(e.endDate,e.startDate)}),cc=s.a.t("Data export"),sc=s.a.t("Export data values as ADX XML, DFX 2 XML, JSON or CSV files."),oc=n.a.createElement(g,null),ic=new Date,mc={selectedOrgUnits:[],includeChildren:!0,selectedDataSets:[],format:Ie,compression:Me,startDate:new Date(ic.getFullYear(),ic.getMonth()-3,ic.getDate()),endDate:ic,includeDeleted:!1,dataElementIdScheme:Ce,orgUnitIdScheme:Ue,idScheme:xe},dc=()=>{const e=(e=>async t=>{const{selectedOrgUnits:a,includeChildren:l,selectedDataSets:n,format:r,compression:c,startDate:o,endDate:i,includeDeleted:m,dataElementIdScheme:d,orgUnitIdScheme:u,idScheme:p}=t;try{const{sets:t}=await e.query(nc,{variables:{dataElementIdScheme:d.value,orgUnitIdScheme:u.value,idScheme:p.value,includeDeleted:m.toString(),children:l.toString(),startDate:q(o),endDate:q(i),orgUnit:a.map(e=>K(e)),dataSet:n,format:r.value}}),s="json"===r.value?JSON.stringify(t):t,E="data.".concat(r.value);if(""!==c.value){const e=new lc.a;e.file(E,s),e.generateAsync({type:"blob"}).then(e=>{const t=URL.createObjectURL(e);X(t,"".concat(E,".").concat(c.value))})}else{const e=G(s,r.value);X(e,E)}}catch(E){const e=[{id:"http-".concat((new Date).getTime()),critical:!0,message:"".concat(s.a.t("HTTP error when fetching data"),". ").concat(E.message)}];return console.error("DataExport onExport error: ",E),{[vr]:e}}})(Object(p.c)());return n.a.createElement(ya,{title:cc,desc:sc,icon:oc,dataTest:"page-export-data"},n.a.createElement(nt.b,{onSubmit:e,initialValues:mc,validate:rc,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,values:a,submitError:l})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(jl,null),n.a.createElement(Il,{value:a.includeChildren}),n.a.createElement(kl,null),n.a.createElement(La,{availableFormats:re}),n.a.createElement(Ul,{availableCompressions:oe}),n.a.createElement(Ll,null),n.a.createElement(Vl,null),n.a.createElement(ra,null,n.a.createElement(_l,{value:a.includeDeleted}),n.a.createElement(bn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null)),n.a.createElement(ql,null),n.a.createElement(Fa,{alerts:l}))}))},uc=({selectedOrgUnits:e,selectedUsers:t,selectedPrograms:a,selectedTETypes:l,ouMode:n,format:r,includeDeleted:c,includeAllAttributes:s,dataElementIdScheme:o,eventIdScheme:i,orgUnitIdScheme:m,idScheme:d,assignedUserMode:u,teiTypeFilter:p,programStatus:E,followUpStatus:v,programStartDate:b,programEndDate:h,lastUpdatedFilter:g,lastUpdatedStartDate:y,lastUpdatedEndDate:S,lastUpdatedDuration:T})=>{const f={ou:e.map(e=>K(e)).join(";"),ouMode:n.value,format:r.value,includeDeleted:c.toString(),includeAllAttributes:s.toString(),dataElementIdScheme:o.value,eventIdScheme:i.value,orgUnitIdScheme:m.value,idScheme:d.value,assignedUserMode:u.value};return"PROVIDED"==u.value&&Object.assign(f,{assignedUser:t.join(";")}),"PROGRAM"==p.value&&(Object.assign(f,{program:a[0],programStatus:E.value,followUpStatus:v.value}),b&&Object.assign(f,{programStartDate:q(b)}),h&&Object.assign(f,{programEndDate:q(h)})),"TE"==p.value&&Object.assign(f,{trackedEntity:l[0]}),"DATE"==g.value&&(y&&Object.assign(f,{lastUpdatedStartDate:q(y)}),S&&Object.assign(f,{lastUpdatedEndDate:q(S)})),"DURATION"==g.value&&Object.assign(f,{lastUpdatedDuration:T}),f},pc={sets:{resource:"trackedEntityInstances",params:e=>e}},Ec=e=>{const t={};return"PROGRAM"==e.teiTypeFilter.value&&e.programStartDate&&e.programEndDate&&Object.assign(t,{programStartDate:ut(e.programStartDate,e.programEndDate),programEndDate:pt(e.programEndDate,e.programStartDate)}),"DATE"==e.lastUpdatedFilter.value&&e.lastUpdatedStartDate&&e.lastUpdatedEndDate&&Object.assign(t,{lastUpdatedStartDate:ut(e.lastUpdatedStartDate,e.lastUpdatedEndDate),lastUpdatedEndDate:pt(e.lastUpdatedEndDate,e.lastUpdatedStartDate)}),"DATE"!=e.lastUpdatedFilter.value||e.lastUpdatedStartDate||e.lastUpdatedEndDate||Object.assign(t,{lastUpdatedEndDate:s.a.t("At least one of the '{{lastUpdated}}' date fields must be specified",{lastUpdated:"last updated"})}),t},vc=s.a.t("Tracked entity instances export"),bc=s.a.t("Export tracked entity instances in the XML, JSON, JSONP or CSV format."),hc=n.a.createElement(j,null),gc={selectedOrgUnits:[],selectedPrograms:[],selectedTETypes:[],selectedUsers:[],format:Ie,ouMode:Ge,teiTypeFilter:Xe,programStatus:Ye,followUpStatus:We,programStartDate:"",programEndDate:"",compression:Me,lastUpdatedFilter:Ze,lastUpdatedStartDate:"",lastUpdatedEndDate:"",lastUpdatedDuration:"",assignedUserMode:$e,includeDeleted:!1,includeAllAttributes:!1,dataElementIdScheme:Ce,eventIdScheme:Re,orgUnitIdScheme:Ue,idScheme:xe},yc=()=>{const e=(e=>async t=>{const{format:a,compression:l}=t;try{const{sets:n}=await e.query(pc,{variables:uc(t)}),r="json"===a.value?JSON.stringify(n):n,c="trackedEntityInstances.".concat(a.value);if(""!==l.value){const e=new lc.a;e.file(c,r),e.generateAsync({type:"blob"}).then(e=>{const t=URL.createObjectURL(e);X(t,"".concat(c,".").concat(l.value))})}else{const e=G(r,a.value);X(e,c)}}catch(n){const e=[{id:"http-".concat((new Date).getTime()),critical:!0,message:"".concat(s.a.t("HTTP error when fetching tracked entity instances"),". ").concat(n.message)}];return console.error("TEIExport onExport error: ",n),{[vr]:e}}})(Object(p.c)());return n.a.createElement(ya,{title:vc,desc:bc,icon:hc,dataTest:"page-export-tei"},n.a.createElement(nt.b,{onSubmit:e,initialValues:gc,validate:Ec,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,values:a,submitError:l})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(jl,null),n.a.createElement(wn,null),n.a.createElement(Dn,null),n.a.createElement(Al,{show:"PROGRAM"==a.teiTypeFilter.value}),n.a.createElement(Nn,{show:"PROGRAM"==a.teiTypeFilter.value}),n.a.createElement(Mn,{show:"PROGRAM"==a.teiTypeFilter.value}),n.a.createElement(Un,{show:"PROGRAM"==a.teiTypeFilter.value}),n.a.createElement(Fn,{show:"PROGRAM"==a.teiTypeFilter.value}),n.a.createElement(Kn,{show:"TE"==a.teiTypeFilter.value}),n.a.createElement(La,{availableFormats:se}),n.a.createElement(Ul,{availableCompressions:oe}),n.a.createElement(ra,null,n.a.createElement(Hn,null),n.a.createElement(Xn,{show:"DATE"==a.lastUpdatedFilter.value}),n.a.createElement(Zn,{show:"DATE"==a.lastUpdatedFilter.value}),n.a.createElement(nr,{show:"DURATION"==a.lastUpdatedFilter.value}),n.a.createElement(cr,null),n.a.createElement(ur,{show:"PROVIDED"==a.assignedUserMode.value}),n.a.createElement(_l,{value:a.includeDeleted}),n.a.createElement(Er,{value:a.includeAllAttributes}),n.a.createElement(bn,null),n.a.createElement(gn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null)),n.a.createElement(ql,null),n.a.createElement(Fa,{alerts:l}))}))},Sc=()=>({}),Tc=s.a.t("Tracked entity instances import"),fc=s.a.t("Import tracked entity instances from JSON or XML files."),Oc=n.a.createElement(j,null),jc=()=>{const{tasks:{tei:e},addTask:t}=Object(l.useContext)(m),a=Object(_a.g)().query,r=(e=>({files:e.files,format:e.format||Ie,identifier:e.identifier||Le,importReportMode:e.importReportMode||Je,preheatMode:e.preheatMode||ze,importStrategy:e.importStrategy||Ve,atomicMode:e.atomicMode||Ke,mergeMode:e.mergeMode||qe,flushMode:e.flushMode||He,inclusionStrategy:e.inclusionStrategy||Be,skipSharing:!!e.skipSharing,skipValidation:!!e.skipValidation,isAsync:!e.isAsync,dataElementIdScheme:e.dataElementIdScheme||Ce,orgUnitIdScheme:e.orgUnitIdScheme||Ue,eventIdScheme:e.eventIdScheme||Re,idScheme:e.idScheme||xe}))(ee(a,e)),[c,s]=Object(l.useState)(0),[o,i]=Object(l.useState)(!1),{baseUrl:E}=Object(p.b)(),v=(({baseUrl:e,setProgress:t,addTask:a,setShowFullSummaryTask:l})=>async n=>{const{dryRun:r,files:c,format:s,identifier:o,importReportMode:i,preheatMode:m,importStrategy:d,atomicMode:p,mergeMode:E,flushMode:v,skipSharing:b,skipValidation:h,inclusionStrategy:g,isAsync:y,dataElementIdScheme:S,orgUnitIdScheme:T,eventIdScheme:f,idScheme:O}=n,j="".concat(e,"/api/"),w=["importMode=".concat(r?"VALIDATE":"COMMIT"),"identifier=".concat(o.value),"importReportMode=".concat(i.value),"preheatMode=".concat(m.value),"importStrategy=".concat(d.value),"atomicMode=".concat(p.value),"mergeMode=".concat(E.value),"flushMode=".concat(v.value),"skipSharing=".concat(b),"skipValidation=".concat(h),"inclusionStrategy=".concat(g.value),"async=".concat(y),"format=".concat(s.value),"dataElementIdScheme=".concat(S.value),"orgUnitIdScheme=".concat(T.value),"eventIdScheme=".concat(f.value),"idScheme=".concat(O.value)].filter(e=>""!=e).join("&"),k="".concat(j).concat("trackedEntityInstances.json","?").concat(w);try{await $({url:k,file:c[0],format:s.value,type:"TEI_IMPORT",setProgress:t,addEntry:(e,t)=>a("tei",e,Object(u.a)({},t,{jobDetails:n}))})}catch(D){const e=Sc(n);return Object(u.a)({[vr]:[D]},e)}finally{l(!0)}})({baseUrl:E,setProgress:s,addTask:t,setShowFullSummaryTask:i});return n.a.createElement(ya,{title:Tc,desc:fc,icon:Oc,loading:c,dataTest:"page-import-tei",summaryTask:d(e),showFullSummaryTask:o},n.a.createElement(nt.b,{onSubmit:v,initialValues:r,subscription:{values:!0,submitError:!0},render:({handleSubmit:e,form:t,values:a,submitError:l})=>n.a.createElement("form",{onSubmit:e},n.a.createElement(xa,null),n.a.createElement(La,{availableFormats:ne}),n.a.createElement(al,null),n.a.createElement(nl,null),n.a.createElement(cl,null),n.a.createElement(ol,null),n.a.createElement(ml,null),n.a.createElement(ul,null),n.a.createElement(ra,null,n.a.createElement(El,null),n.a.createElement(gl,{value:a.skipSharing}),n.a.createElement(Sl,{value:a.skipValidation}),n.a.createElement(fl,{value:a.isAsync}),n.a.createElement(bl,null),n.a.createElement(bn,null),n.a.createElement(gn,null),n.a.createElement(fn,null),n.a.createElement(Sn,null)),n.a.createElement(Ra,{form:t}),n.a.createElement(Fa,{alerts:l}))}))},wc=()=>n.a.createElement(_a.d,null,n.a.createElement(_a.b,{path:"/import/data",component:tc}),n.a.createElement(_a.b,{path:"/import/event",component:qr}),n.a.createElement(_a.b,{path:"/import/gml",component:Jr}),n.a.createElement(_a.b,{path:"/import/metadata",component:Sr}),n.a.createElement(_a.b,{path:"/import/tei",component:jc}),n.a.createElement(_a.b,{path:"/export/data",component:dc}),n.a.createElement(_a.b,{path:"/export/event",component:Zr}),n.a.createElement(_a.b,{path:"/export/metadata-dependency",component:Ir}),n.a.createElement(_a.b,{path:"/export/metadata",component:wr}),n.a.createElement(_a.b,{path:"/export/tei",component:yc}),n.a.createElement(_a.b,{path:"/utils/job-overview",component:Cr}),n.a.createElement(_a.a,{from:"*",to:"/import/data"}));var kc=a(202),Dc=a.n(kc);const Ac=({name:e,dataTest:t,label:a,options:l,setValue:r,selected:c,noMatchText:s,loading:i,error:m,meta:d,warning:u,validationText:p,helpText:E,filled:v,dense:b,filterable:h,initialFocus:g})=>{const y=l.map(e=>n.a.createElement(o.F,{key:e.value,value:e.value,label:e.label}));return n.a.createElement(jt,{label:a,dataTest:t},n.a.createElement("div",{className:Dc.a.select,"data-test":"".concat(t,"-container")},n.a.createElement(o.E,{dense:b,filled:v,initialFocus:g,loading:i,warning:u,error:m,name:e,onChange:({selected:e})=>r(e),selected:c,filterable:h,noMatchText:s||"No match found for filter",helpText:E,validationText:p,dataTest:"".concat(t,"-ssf")},y),(d.touched||!d.pristine)&&d.error&&n.a.createElement(o.o,{error:!0},d.error)))},Nc=e=>{let{input:{value:t,onChange:a},meta:l,inputName:r}=e,c=Object(lt.a)(e,["input","meta","inputName"]);return n.a.createElement(Ac,Object.assign({name:r,meta:l,selected:t||void 0,setValue:a},c))},Ic=e=>{let{name:t}=e,a=Object(lt.a)(e,["name"]);return n.a.createElement(nt.a,Object.assign({component:Nc,name:t,inputName:t},a))};var Mc=a(203),_c=a.n(Mc);const Cc=({label:e,name:t,selected:a,setSelected:r,list:c,multiSelect:i,withFilter:m,withActions:d,dataTest:u})=>{const[p,E]=Object(l.useState)(""),v=({value:e})=>{if(i){const t=!a.includes(e);r(0==t?a.filter(t=>t!=e):[...a,e])}else r([e])};return n.a.createElement("div",{"data-test":u},m&&n.a.createElement("div",{className:_c.a.filter,"data-test":"".concat(u,"-filter")},n.a.createElement(o.p,{name:"filter",label:e,value:p,onChange:({value:e})=>E(e),dense:!0})),d&&n.a.createElement("div",{className:_c.a.actions,"data-test":"".concat(u,"-actions")},n.a.createElement(o.b,{className:_c.a.action,onClick:()=>{if(i){const e=c.map(({value:e})=>e);r(e)}},dataTest:"".concat(u,"-actions-select-all")},s.a.t("Select all")),n.a.createElement(o.b,{className:_c.a.action,onClick:()=>{i&&r([])},dataTest:"".concat(u,"-actions-clear-all")},s.a.t("Clear all"))),n.a.createElement("div",{className:_c.a.body,"data-test":"".concat(u,"-body"),name:t},c.filter(({label:e})=>e.toLowerCase().includes(p.toLowerCase())).map(({value:e,label:l})=>{const r=i?n.a.createElement(o.e,{value:e,name:t,label:l,checked:a.includes(e),onChange:()=>0}):n.a.createElement(o.B,{value:e,name:t,label:l,checked:a.includes(e),onChange:()=>0});return n.a.createElement(o.t,{dataTest:"".concat(u,"-body-li-").concat(e),key:"".concat(u,"-body-li-").concat(e),value:e,label:r,onClick:v})})))};var Uc=a(204),xc=a.n(Uc);const Rc={name:s.a.t("Data import"),code:"data-import",icon:n.a.createElement(g,null),path:"/import/data"},Fc={name:s.a.t("Event import"),code:"event-import",icon:n.a.createElement(y,null),path:"/import/event"},Pc={name:s.a.t("GML import"),code:"gml-import",icon:n.a.createElement(S,null),path:"/import/gml"},Lc={name:s.a.t("Metadata import"),code:"metadata-import",path:"/import/metadata",icon:n.a.createElement(v,null)},Jc={name:s.a.t("TEI import"),code:"tei-import",path:"/import/tei",icon:n.a.createElement(j,null)},zc={name:s.a.t("Data export"),code:"data-export",path:"/export/data",icon:n.a.createElement(g,null)},Vc={name:s.a.t("Event export"),code:"event-export",path:"/export/event",icon:n.a.createElement(y,null)},Kc={name:s.a.t("Metadata dependency export"),code:"metadata-dependency-export",path:"/export/metadata-dependency",icon:n.a.createElement(h,null)},qc={name:s.a.t("Metadata export"),code:"metadata-export",path:"/export/metadata",icon:n.a.createElement(b,null)},Hc={name:s.a.t("TEI export"),code:"tei-export",path:"/export/tei",icon:n.a.createElement(j,null)},Bc=[Rc,Fc,Pc,Lc,Jc],Gc=[zc,Vc,Kc,qc,Hc],Xc={name:s.a.t("Job overview"),code:"job-overview",path:"/utils/job-overview",icon:n.a.createElement(O,null)},Yc=({name:e,path:t,code:a,icon:l,active:r,className:c})=>n.a.createElement(Qc,{to:t,dataTest:"sidebar-link-".concat(a)},n.a.createElement(o.t,{active:r,icon:l,label:e,className:c})),Wc=()=>{const e=Object(_a.g)().pathname;return n.a.createElement(o.s,{className:xc.a.Menu},n.a.createElement("h3",{className:xc.a.sectionTitle},s.a.t("Import")),Bc.map(({icon:t,name:a,code:l,path:r})=>{const c=e==r;return n.a.createElement(Yc,{name:a,path:r,code:l,icon:t,active:c,key:r})}),n.a.createElement(o.l,null),n.a.createElement("h3",{className:xc.a.sectionTitle},s.a.t("Export")),Gc.map(({icon:t,name:a,code:l,path:r})=>{const c=e==r;return n.a.createElement(Yc,{name:a,path:r,code:l,icon:t,active:c,key:r})}),n.a.createElement(o.l,null),n.a.createElement(Yc,{name:Xc.name,path:Xc.path,code:Xc.code,icon:Xc.icon,active:e==Xc.path,className:e==Xc.path?"":xc.a.jobOverview,key:Xc.path}))};var Zc=a(205),$c=a.n(Zc);const Qc=e=>{let{dataTest:t}=e,a=Object(lt.a)(e,["dataTest"]);return n.a.createElement(r.b,Object.assign({"data-test":t,className:$c.a.link},a))},es=({name:e,label:t,help:a,value:l,dataTest:r})=>n.a.createElement(jt,{label:t,dataTest:r},n.a.createElement(nt.a,{component:ht.b,name:e,label:l?s.a.t("Yes"):s.a.t("No"),helpText:a,dataTest:"".concat(r,"-sf")})),ts=({pred:e,children:t})=>{const a=Object(l.useContext)(i);return a&&e(a.authorities)?t:null},as={teTypes:{resource:"trackedEntityTypes",params:{fields:"id,displayName",paging:"false"}}},ls=({label:e,selected:t,setSelected:a,meta:r,dataTest:c,multiSelect:i,withFilter:m,withActions:d,autoSelectFirst:u})=>{const[E,v]=Object(l.useState)([]),{error:b,loading:h}=Object(p.d)(as,{onComplete:e=>{const t=e.teTypes.trackedEntityTypes.map(({id:e,displayName:t})=>({value:e,label:t}));v(t),u&&a([t[0].value])},onError:e=>{console.error("TETypePicker error: ",e)}}),g=!h&&!b;return n.a.createElement(jt,{label:e,dataTest:c},h&&n.a.createElement(o.i,{dataTest:"".concat(c,"-loading")}),b&&n.a.createElement("div",{"data-test":"".concat(c,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the tracked entity types!")),n.a.createElement("p",null,b.message)),g&&n.a.createElement(Cc,{name:"teTypePicker",label:s.a.t("Filter tracked entity types by name"),selected:t,setSelected:a,multiSelect:i,list:E,withFilter:m,withActions:d,dataTest:"".concat(c,"-list")}),(r.touched||!r.pristine)&&r.error&&n.a.createElement(o.o,{error:!0},r.error))};ls.defaultProps={multiSelect:!1,withFilter:!0,withActions:!1,autoSelectFirst:!0};const ns={users:{resource:"users",params:{fields:"id,displayName",paging:"false"}}},rs=({label:e,selected:t,setSelected:a,meta:r,dataTest:c,multiSelect:i,withFilter:m,withActions:d,autoSelectFirst:u})=>{const[E,v]=Object(l.useState)([]),{error:b,loading:h}=Object(p.d)(ns,{onComplete:e=>{const t=e.users.users.map(({id:e,displayName:t})=>({value:e,label:t}));v(t),u&&a([t[0].value])},onError:e=>{console.error("UserPicker error: ",e)}}),g=!h&&!b;return n.a.createElement(jt,{label:e,dataTest:c},h&&n.a.createElement(o.i,{dataTest:"".concat(c,"-loading")}),b&&n.a.createElement("div",{"data-test":"".concat(c,"-error")},n.a.createElement("p",null,s.a.t("Something went wrong when loading the users!")),n.a.createElement("p",null,b.message)),g&&n.a.createElement(Cc,{name:"userPicker",label:s.a.t("Filter users by name"),selected:t,setSelected:a,multiSelect:i,list:E,withFilter:m,withActions:d,dataTest:"".concat(c,"-list")}),(r.touched||!r.pristine)&&r.error&&n.a.createElement(o.o,{error:!0},r.error))};rs.defaultProps={multiSelect:!0,withFilter:!0,withActions:!1,autoSelectFirst:!0};t.default=()=>{const{tasks:e,addTask:t,jobOverview:a,updateJobOverview:l}=M(),{loading:c,error:d,user:u}=(()=>{const{loading:e,error:t,data:a}=Object(p.d)(_);return t&&console.log("useUser error: ",t),{loading:e,error:t,user:a&&a.user}})(),E=!c&&!d;return n.a.createElement(n.a.Fragment,null,n.a.createElement(o.k,null),c&&n.a.createElement(o.D,{dataTest:"app-screen-cover"},n.a.createElement(o.i,{dataTest:"app-loader"})),d&&n.a.createElement("div",{"data-test":"app-error"},n.a.createElement("p",null,s.a.t("Something went wrong when loading the current user!")),n.a.createElement("p",null,d.message)),E&&n.a.createElement(r.a,null,n.a.createElement(i.Provider,{value:u},n.a.createElement(m.Provider,{value:{tasks:e,addTask:t,jobOverview:a,updateJobOverview:l}},n.a.createElement("div",{className:F.a.container},n.a.createElement("div",{className:F.a.sidebar},n.a.createElement(Wc,null)),n.a.createElement("div",{className:F.a.content},n.a.createElement(wc,null)))))))}}}]);
//# sourceMappingURL=app.a16b2c4d.chunk.js.map